/* $Id$        */
/*--------------------------------------------------------------------*/
/*;  Copyright (C) 2010,2012                                          */
/*;  Associated Universities, Inc. Washington DC, USA.                */
/*;                                                                   */
/*;  This program is free software; you can redistribute it and/or    */
/*;  modify it under the terms of the GNU General Public License as   */
/*;  published by the Free Software Foundation; either version 2 of   */
/*;  the License, or (at your option) any later version.              */
/*;                                                                   */
/*;  This program is distributed in the hope that it will be useful,  */
/*;  but WITHOUT ANY WARRANTY; without even the implied warranty of   */
/*;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    */
/*;  GNU General Public License for more details.                     */
/*;                                                                   */
/*;  You should have received a copy of the GNU General Public        */
/*;  License along with this program; if not, write to the Free       */
/*;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,     */
/*;  MA 02139, USA.                                                   */
/*;                                                                   */
/*;Correspondence about this software should be addressed as follows: */
/*;         Internet email: bcotton@nrao.edu.                         */
/*;         Postal address: William Cotton                            */
/*;                         National Radio Astronomy Observatory      */
/*;                         520 Edgemont Road                         */
/*;                         Charlottesville, VA 22903-2475 USA        */
/*--------------------------------------------------------------------*/
#include "ObitVLAGain.h"
#include "ObitUVDesc.h"
#include "ObitUtil.h"

/*----------------Obit: Merx mollis mortibus nuper ------------------*/
/**
 * \file ObitVLAGain.c
 * ObitVLAGain utility function definitions.
 */

/**
 * Private
 * Get polynomial gain curves at a set of frequencies from those at another
 * Polynomials are in terms of zenith angle (deg)
 * \param inTerm     Number of polynomial terms
 * \param inNFreq    Number of input frequencies
 * \param inFreqs    Array of input frequencies (Hz) asc. order
 * \param inPoly     Polynomial curves at inFreqs [freq][term]
 * \param outNFreq   Number of output frequencies
 * \param outFreqs   Array of output frequencies (Hz) asc. order
 * \param outPoly   [out] polynomials at outFreqs
 */
static void GetGainCurves (olong nTerm, 
			   olong inNFreq, odouble *inFreqs, ofloat **inPoly, 
			   olong outNFreq, odouble *outFreqs, ofloat **outPoly)
{
  olong nZA=30;   /* Number of zenith angles tabulated over 0-90 deg */
  olong i, j, iZA, iHi, iLo;
  ofloat ZA, delta, wtLo, wtHi;
  ofloat *ZAs=NULL, *wt=NULL, **curves=NULL, *curveInp=NULL;

  /* If only one, just copy */
  if (inNFreq==1) {
    for (i=0; i<outNFreq; i++) {
      for (j=0; j<nTerm; j++) {
	outPoly[i][j] = inPoly[0][j];
      }
    }
    return;
  } /* end of only one */

  /* work arrays */
  curveInp = g_malloc0(nZA*sizeof(ofloat));
  ZAs      = g_malloc0(nZA*sizeof(ofloat));
  wt       = g_malloc0(nZA*sizeof(ofloat));
  curves   = g_malloc0(inNFreq*sizeof(ofloat*));
  for (i=0; i<inNFreq; i++) curves[i] = g_malloc0(nZA*sizeof(ofloat));

  /* Create input curves */
  delta = 90.0 / nZA;
  for (iZA=0; iZA<nZA; iZA++) {
    ZA       = iZA * delta;     /* Zenith angle */
    ZAs[iZA] = ZA;
    wt[iZA]  = 1.0;             /* Weight */
    for (i=0; i<inNFreq; i++) {
      curves[i][iZA] = inPoly[i][0] + inPoly[i][1]*ZA + inPoly[i][2]*ZA*ZA + inPoly[i][3]*ZA*ZA*ZA;
    }
  }

  /* Interpolate/Fit output curves */
  for (i=0; i<outNFreq; i++) {
    /* Find frequency in input arrays */
    iHi = iLo = 0;  /* In case lower freq than all input */
    for (j=1; j<inNFreq; j++) {
      if ((outFreqs[i]>=inFreqs[j-1]) && (outFreqs[i]<=inFreqs[j])) {
	iHi = j; iLo = j-1; break;
			      }
    } /* end loop find frequency in input */
    /* Check if freq higher than all input */
    if (outFreqs[i]>inFreqs[inNFreq-1]) iHi = iLo = inNFreq-1;

    /* Get interpolation weights */
    if (iHi == iLo) {wtLo = 1.0; wtHi = 0.0;}  /* Same */
    else {  /* not the same */
      wtLo = fabs(inFreqs[iHi] - outFreqs[i]) / fabs(inFreqs[iHi] - inFreqs[iLo]);
      wtHi = 1.0 - wtLo;
    }
    
    /* Interpolate */
    for (iZA=0; iZA<nZA; iZA++) curveInp[iZA] = wtLo*curves[iLo][iZA] + wtHi*curves[iHi][iZA];

    /* Fit */
    FitPoly (outPoly[i], 3, ZAs, curveInp, wt, nZA);

  } /* End loop interpolating/fitting output curves */

  /* Cleanup */
  if (curveInp) g_free(curveInp);
  if (ZAs)      g_free(ZAs);
  if (wt)       g_free(wt);
  if (curves) {
    for (i=0; i<inNFreq; i++) if (curves[i]) g_free(curves[i]);
    g_free(curves);
  }

} /* end GetGainCurves */

/**
 *  Get VLA Gain Curve parameters from list of measurements
 *  Returned as polynomial in zenith angle (deg)
 * \param Ant      Antenna number
 * \param JD       Julian data desired
 * \param Freq     Average frequency (Hz), to get correct band
 * \param nfreq   [number of frequencies to get gains for
 * \param gainFreq Array of frequencies (Hz) to get gains for
 * \param gain     [out] Array of arrays gain polynomial coefficients
 *                 [freq][term] 4 terms implemented
 */
void ObitVLAGainParseGain (olong Ant, odouble JD, odouble Freq, 
			   olong nfreq, odouble *gainFreq, ofloat **gain)
{
  olong i, iarray=-1, n, iline, date, sdate, edate, antno, yr, mo, day;
  ofloat avgGain[5] = {1.0, 0.0,0.0,0.0,0.0};  /* Flat gain if all else fails */
  ofloat **garray=NULL;   /* Gains for up to eight frequencies */
  odouble farray[8] = {0.,0.,0.,0.,0.,0.,0.,0.};     /* Frequencies of gains */
  olong narray=0;        /* Number of frequencies found */
  gboolean found, gotBand;
  gchar *line, band, datestr[12];
  /* gain curve file for the VLA.  bjb.  2003may13.                          */
  /* the format of the lines looks like:                                     */
  /* bb aa yyy1m1d1 yyy2m2d2 c0 c1 c2 c3                                     */
  /* where:                                                                  */
  /* b = band designation (currently one of: 4, P, L, S, C, X, U, K, A, Q)   */
  /* aa = antenna number.  if aa=0, this is an average over all antennas.    */
  /* yyyy1 m1 d1 = year, month, day before which this gain curve entry is    */
  /*               not valid                                                 */
  /* yyyy2 m2 d2 = year, month, day after which this gain curve entry is     */
  /*               not valid                                                 */
  /* c0, c1, c2, c3 = gain curve coefficients                                */
  /*                                                                         */
  /* The date strings are 8 consecutive characters with no blanks            */
  /* As NULL terminated list of strings ordered by time and band             */
  /* Band antenna and dates fixed format                                     */
  gchar *gainLines[] = {
    /*;-----------------------------------------------------------------------*/
    /*;*/
    /*; X-band (8435 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "X  8435.0  2 20100101 20120101  9.6265E-01  1.5535E-03 -1.5078E-05  0.0000E+00",
    "X  8435.0  3 20100101 20120101  9.3894E-01  1.8145E-03 -1.0815E-05  0.0000E+00",
    "X  8435.0  4 20100101 20120101  9.6481E-01  2.6396E-03 -2.8097E-05  0.0000E+00",
    "X  8435.0  5 20100101 20120101  9.8866E-01  1.3858E-03 -1.8814E-05  0.0000E+00",
    "X  8435.0  6 20100101 20120101  9.7133E-01  1.6258E-03 -1.6037E-05  0.0000E+00",
    "X  8435.0  7 20100101 20120101  9.4047E-01  2.2265E-03 -1.7827E-05  0.0000E+00",
    "X  8435.0  8 20100101 20120101  9.6867E-01  2.0708E-03 -2.3765E-05  0.0000E+00",
    "X  8435.0  9 20100101 20120101  9.8570E-01  3.5641E-05  2.2029E-06  0.0000E+00",
    "X  8435.0 13 20100101 20120101  9.2090E-01  3.6598E-03 -3.3250E-05  0.0000E+00",
    "X  8435.0 14 20100101 20120101  9.3978E-01  2.3828E-03 -1.9572E-05  0.0000E+00",
    "X  8435.0 15 20100101 20120101  9.5204E-01  2.2605E-03 -2.2856E-05  0.0000E+00",
    "X  8435.0 16 20100101 20120101  9.3219E-01  2.2083E-03 -1.3900E-05  0.0000E+00",
    "X  8435.0 18 20100101 20120101  9.8010E-01  2.2415E-03 -2.9241E-05  0.0000E+00",
    "X  8435.0 19 20100101 20120101  8.7727E-01  3.7708E-03 -2.3315E-05  0.0000E+00",
    "X  8435.0 20 20100101 20120101  9.8369E-01  1.3191E-03 -1.4968E-05  0.0000E+00",
    "X  8435.0 21 20100101 20120101  9.2792E-01  2.6046E-03 -1.9864E-05  0.0000E+00",
    "X  8435.0 23 20100101 20120101  8.9312E-01  3.6995E-03 -3.0409E-05  0.0000E+00",
    "X  8435.0 24 20100101 20120101  9.3567E-01  2.5241E-03 -1.7583E-05  0.0000E+00",
    "X  8435.0 25 20100101 20120101  9.3682E-01  2.1235E-03 -1.5944E-05  0.0000E+00",
    "X  8435.0 27 20100101 20120101  9.7165E-01  1.6931E-03 -1.9875E-05  0.0000E+00",
    "X  8435.0 28 20100101 20120101  1.0185E+00  1.1962E-03 -1.9621E-05  0.0000E+00",
    "X  8435.0  0 20100101 20120101  9.5195E-01  2.1446E-03 -1.9458E-05  0.0000E+00",
    /*;*/
    /*; X-band (8735 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "X  8735.0  2 20100101 20120101  9.9451E-01  2.4063E-04 -2.6087E-06  0.0000E+00",
    "X  8735.0  3 20100101 20120101  1.0098E+00 -1.2278E-04 -1.0773E-06  0.0000E+00",
    "X  8735.0  4 20100101 20120101  1.0082E+00  7.3512E-05 -3.0627E-06  0.0000E+00",
    "X  8735.0  5 20100101 20120101  1.0082E+00 -2.8939E-05 -1.3006E-06  0.0000E+00",
    "X  8735.0  6 20100101 20120101  9.9176E-01  2.9827E-04 -2.9091E-06  0.0000E+00",
    "X  8735.0  7 20100101 20120101  9.8403E-01  5.9384E-04 -5.8515E-06  0.0000E+00",
    "X  8735.0  8 20100101 20120101  9.9279E-01  2.1266E-04 -1.9601E-06  0.0000E+00",
    "X  8735.0  9 20100101 20120101  9.9954E-01  2.9984E-04 -3.2761E-06  0.0000E+00",
    "X  8735.0 10 20100101 20120101  1.0051E+00 -5.6054E-05 -1.2307E-06  0.0000E+00",
    "X  8735.0 13 20100101 20120101  9.7210E-01  9.8566E-04 -6.7607E-06  0.0000E+00",
    "X  8735.0 14 20100101 20120101  9.8900E-01  4.5017E-04 -3.6850E-06  0.0000E+00",
    "X  8735.0 15 20100101 20120101  9.9346E-01  1.9348E-04 -1.3413E-06  0.0000E+00",
    "X  8735.0 16 20100101 20120101  1.0031E+00  7.9776E-05 -1.8880E-06  0.0000E+00",
    "X  8735.0 18 20100101 20120101  9.9468E-01  1.7716E-04 -1.3111E-06  0.0000E+00",
    "X  8735.0 19 20100101 20120101  1.0038E+00 -2.2186E-04  2.0515E-06  0.0000E+00",
    "X  8735.0 20 20100101 20120101  1.0002E+00  4.2355E-05 -1.7185E-06  0.0000E+00",
    "X  8735.0 21 20100101 20120101  9.9867E-01  1.3657E-04 -1.9665E-06  0.0000E+00",
    "X  8735.0 23 20100101 20120101  1.0021E+00  1.1623E-04 -1.5499E-06  0.0000E+00",
    "X  8735.0 24 20100101 20120101  9.9707E-01  1.3008E-04 -2.3093E-06  0.0000E+00",
    "X  8735.0 25 20100101 20120101  9.9883E-01  2.5509E-04 -3.3059E-06  0.0000E+00",
    "X  8735.0  0 20100101 20120101  9.9735E-01  1.9278E-04 -2.3531E-06  0.0000E+00",
    /*;*/
    /*; K-band (18585 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "K 18585.0  1 20100101 20120101  9.8193E-01  7.9328E-04 -8.4227E-06  0.0000E+00",
    "K 18585.0  2 20100101 20120101  9.4731E-01  1.5223E-03 -6.8538E-06  0.0000E+00",
    "K 18585.0  3 20100101 20120101  9.4606E-01  3.4730E-03 -3.3196E-05  0.0000E+00",
    "K 18585.0  4 20100101 20120101  9.8541E-01  1.2440E-03 -1.6705E-05  0.0000E+00",
    "K 18585.0  5 20100101 20120101  9.7403E-01  1.7409E-03 -1.7936E-05  0.0000E+00",
    "K 18585.0  6 20100101 20120101  9.4553E-01  1.9860E-03 -1.5892E-05  0.0000E+00",
    "K 18585.0  7 20100101 20120101  9.6634E-01  1.8332E-03 -2.0492E-05  0.0000E+00",
    "K 18585.0  8 20100101 20120101  1.0666E+00 -2.8460E-03  2.5594E-05  0.0000E+00",
    "K 18585.0  9 20100101 20120101  8.9908E-01  4.7833E-03 -4.1147E-05  0.0000E+00",
    "K 18585.0 15 20100101 20120101  9.4207E-01  1.6735E-03 -1.0233E-05  0.0000E+00",
    "K 18585.0 18 20100101 20120101  8.9787E-01  3.3912E-03 -2.2286E-05  0.0000E+00",
    "K 18585.0 19 20100101 20120101  1.0108E+00  4.6725E-04 -9.3313E-06  0.0000E+00",
    "K 18585.0 20 20100101 20120101  9.2603E-01  2.4597E-03 -1.6712E-05  0.0000E+00",
    "K 18585.0 21 20100101 20120101  8.7690E-01  4.7534E-03 -3.8518E-05  0.0000E+00",
    "K 18585.0 23 20100101 20120101  9.1928E-01  3.2737E-03 -2.2760E-05  0.0000E+00",
    "K 18585.0 24 20100101 20120101  9.5265E-01  1.4880E-03 -1.0511E-05  0.0000E+00",
    "K 18585.0 25 20100101 20120101  9.7985E-01  1.3799E-03 -1.5923E-05  0.0000E+00",
    "K 18585.0 27 20100101 20120101  9.9994E-01  1.9381E-03 -2.2896E-05  0.0000E+00",
    "K 18585.0  0 20100101 20120101  9.5653E-01  1.9642E-03 -1.6901E-05  0.0000E+00",
    /*;*/
    /*; K-band (22485 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "K 22485.0  1 20100101 20120101  9.4337E-01  2.3136E-03 -2.1733E-05  0.0000E+00",
    "K 22485.0  2 20100101 20120101  9.3057E-01  2.1067E-03 -1.4777E-05  0.0000E+00",
    "K 22485.0  3 20100101 20120101  9.8355E-01  1.8062E-03 -2.2997E-05  0.0000E+00",
    "K 22485.0  4 20100101 20120101  9.9190E-01  1.5277E-03 -2.0923E-05  0.0000E+00",
    "K 22485.0  5 20100101 20120101  9.6863E-01  1.5107E-03 -1.4137E-05  0.0000E+00",
    "K 22485.0  6 20100101 20120101  9.3540E-01  2.4671E-03 -1.9763E-05  0.0000E+00",
    "K 22485.0  7 20100101 20120101  9.7101E-01  2.3083E-03 -2.7037E-05  0.0000E+00",
    "K 22485.0  8 20100101 20120101  9.0482E-01  2.9173E-03 -2.1188E-05  0.0000E+00",
    "K 22485.0  9 20100101 20120101  9.4273E-01  2.5363E-03 -2.5353E-05  0.0000E+00",
    "K 22485.0 13 20100101 20120101  9.3978E-01  2.3828E-03 -1.9572E-05  0.0000E+00",
    "K 22485.0 14 20100101 20120101  9.5204E-01  2.2605E-03 -2.2856E-05  0.0000E+00",
    "K 22485.0 15 20100101 20120101  9.2230E-01  2.7430E-03 -1.7566E-05  0.0000E+00",
    "K 22485.0 16 20100101 20120101  9.8010E-01  2.2415E-03 -2.9241E-05  0.0000E+00",
    "K 22485.0 18 20100101 20120101  8.5666E-01  4.1503E-03 -2.4345E-05  0.0000E+00",
    "K 22485.0 19 20100101 20120101  9.5662E-01  2.1710E-03 -2.0604E-05  0.0000E+00",
    "K 22485.0 20 20100101 20120101  9.2981E-01  2.7495E-03 -2.3016E-05  0.0000E+00",
    "K 22485.0 21 20100101 20120101  9.0934E-01  2.6455E-03 -2.2299E-05  0.0000E+00",
    "K 22485.0 23 20100101 20120101  9.5205E-01  1.7745E-03 -1.2406E-05  0.0000E+00",
    "K 22485.0 24 20100101 20120101  9.2100E-01  2.7590E-03 -2.1377E-05  0.0000E+00",
    "K 22485.0 25 20100101 20120101  9.6345E-01  2.0063E-03 -2.3826E-05  0.0000E+00",
    "K 22485.0 27 20100101 20120101  1.0370E+00  4.5431E-04 -1.6346E-05  0.0000E+00",
    "K 22485.0  0 20100101 20120101  9.4725E-01  2.2777E-03 -2.1017E-05  0.0000E+00",
    /*;*/
    /*; A-band (29735 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "A 29735.0  2 20100101 20120101  8.4448E-01  5.8829E-03 -4.9348E-05  0.0000E+00",
    "A 29735.0  3 20100101 20120101  8.2097E-01  6.8729E-03 -5.7953E-05  0.0000E+00",
    "A 29735.0  4 20100101 20120101  8.5494E-01  5.3640E-03 -4.6044E-05  0.0000E+00",
    "A 29735.0  5 20100101 20120101  8.9639E-01  4.6667E-03 -4.5434E-05  0.0000E+00",
    "A 29735.0  6 20100101 20120101  9.3107E-01  3.4137E-03 -3.5503E-05  0.0000E+00",
    "A 29735.0  7 20100101 20120101  9.1978E-01  5.7202E-03 -6.8325E-05  0.0000E+00",
    "A 29735.0  8 20100101 20120101  8.4734E-01  5.8383E-03 -4.6515E-05  0.0000E+00",
    "A 29735.0  9 20100101 20120101  9.6374E-01  3.4221E-03 -4.5669E-05  0.0000E+00",
    "A 29735.0 15 20100101 20120101  7.7849E-01  6.5073E-03 -3.9420E-05  0.0000E+00",
    "A 29735.0 19 20100101 20120101  1.0359E+00  9.7801E-04 -2.9377E-05  0.0000E+00",
    "A 29735.0 20 20100101 20120101  8.6494E-01  5.7658E-03 -5.3855E-05  0.0000E+00",
    "A 29735.0 23 20100101 20120101  9.3729E-01  2.6186E-03 -2.5575E-05  0.0000E+00",
    "A 29735.0 24 20100101 20120101  8.9147E-01  3.8397E-03 -2.9059E-05  0.0000E+00",
    "A 29735.0 25 20100101 20120101  8.7821E-01  5.0364E-03 -4.6754E-05  0.0000E+00",
    "A 29735.0 27 20100101 20120101  1.0097E+00  1.5996E-03 -2.8116E-05  0.0000E+00",
    "A 29735.0  0 20100101 20120101  8.9831E-01  4.5017E-03 -4.3130E-05  0.0000E+00",
    /*;*/
    /*; A-band (36435 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "A 36435.0  2 20100101 20120101  8.5349E-01  5.8489E-03 -5.5071E-05  0.0000E+00",
    "A 36435.0  3 20100101 20120101  8.8549E-01  4.9566E-03 -4.8645E-05  0.0000E+00",
    "A 36435.0  4 20100101 20120101  8.4033E-01  6.3315E-03 -5.7510E-05  0.0000E+00",
    "A 36435.0  5 20100101 20120101  9.3108E-01  4.6914E-03 -5.2915E-05  0.0000E+00",
    "A 36435.0  6 20100101 20120101  9.2283E-01  4.6304E-03 -5.2286E-05  0.0000E+00",
    "A 36435.0  7 20100101 20120101  8.5853E-01  5.6902E-03 -5.1779E-05  0.0000E+00",
    "A 36435.0  8 20100101 20120101  8.4857E-01  5.7783E-03 -4.6854E-05  0.0000E+00",
    "A 36435.0  9 20100101 20120101  1.0023E+00  2.7645E-03 -4.4928E-05  0.0000E+00",
    "A 36435.0 15 20100101 20120101  6.7562E-01  9.6988E-03 -5.5248E-05  0.0000E+00",
    "A 36435.0 19 20100101 20120101  9.9922E-01  4.2268E-03 -6.5221E-05  0.0000E+00",
    "A 36435.0 20 20100101 20120101  8.4017E-01  7.0499E-03 -6.8560E-05  0.0000E+00",
    "A 36435.0 23 20100101 20120101  8.9914E-01  4.8174E-03 -4.8314E-05  0.0000E+00",
    "A 36435.0 24 20100101 20120101  8.6337E-01  4.2928E-03 -2.9556E-05  0.0000E+00",
    "A 36435.0 25 20100101 20120101  8.7519E-01  5.2987E-03 -4.8747E-05  0.0000E+00",
    "A 36435.0 27 20100101 20120101  1.0018E+00  2.5765E-03 -3.9376E-05  0.0000E+00",
    "A 36435.0  0 20100101 20120101  8.8647E-01  5.2435E-03 -5.1001E-05  0.0000E+00",
    /*;*/
    /*; Q-band (43365 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "Q 43365.0  1 20100101 20120101  8.8098E-01  7.7871E-03 -8.7884E-05  0.0000E+00",
    "Q 43365.0  2 20100101 20120101  6.3655E-01  1.2949E-02 -9.8623E-05  0.0000E+00",
    "Q 43365.0  3 20100101 20120101  9.0582E-01  5.0526E-03 -6.0890E-05  0.0000E+00",
    "Q 43365.0  4 20100101 20120101  8.5424E-01  7.7768E-03 -7.9930E-05  0.0000E+00",
    "Q 43365.0  5 20100101 20120101  8.4338E-01  6.5818E-03 -6.3738E-05  0.0000E+00",
    "Q 43365.0  6 20100101 20120101  7.4743E-01  9.0999E-03 -7.6562E-05  0.0000E+00",
    "Q 43365.0  7 20100101 20120101  7.0151E-01  1.1155E-02 -9.5669E-05  0.0000E+00",
    "Q 43365.0  8 20100101 20120101  6.7212E-01  1.1842E-02 -8.8755E-05  0.0000E+00",
    "Q 43365.0  9 20100101 20120101  8.0634E-01  9.4306E-03 -9.2032E-05  0.0000E+00",
    "Q 43365.0 13 20100101 20120101  6.9556E-01  9.4308E-03 -6.0895E-05  0.0000E+00",
    "Q 43365.0 15 20100101 20120101  6.5934E-01  9.9287E-03 -5.5844E-05  0.0000E+00",
    "Q 43365.0 18 20100101 20120101  5.8096E-01  1.2914E-02 -9.4621E-05  0.0000E+00",
    "Q 43365.0 19 20100101 20120101  8.8051E-01  6.8336E-03 -8.0828E-05  0.0000E+00",
    "Q 43365.0 21 20100101 20120101  8.5460E-01  5.0142E-03 -3.1232E-05  0.0000E+00",
    "Q 43365.0 23 20100101 20120101  7.0297E-01  1.1600E-02 -9.2270E-05  0.0000E+00",
    "Q 43365.0 24 20100101 20120101  6.8870E-01  1.1160E-02 -8.0841E-05  0.0000E+00",
    "Q 43365.0 25 20100101 20120101  8.4447E-01  6.7552E-03 -6.8633E-05  0.0000E+00",
    "Q 43365.0 27 20100101 20120101  5.3221E-01  1.4017E-02 -9.2635E-05  0.0000E+00",
    "Q 43365.0  0 20100101 20120101  7.4931E-01  9.4072E-03 -7.7882E-05  0.0000E+00",
    /*;*/
    /*; Q-band (48365 MHz) gains from flux density run in January 2010.*/
    /*;*/
    "Q 48365.0  1 20100101 20120101  8.9729E-01  8.6289E-03 -1.0853E-04  0.0000E+00",
    "Q 48365.0  2 20100101 20120101  8.2767E-01  7.4099E-03 -6.2810E-05  0.0000E+00",
    "Q 48365.0  3 20100101 20120101  8.6844E-01  6.7098E-03 -7.2614E-05  0.0000E+00",
    "Q 48365.0  4 20100101 20120101  6.9877E-01  1.4241E-02 -1.3711E-04  0.0000E+00",
    "Q 48365.0  5 20100101 20120101  7.9655E-01  9.8641E-03 -9.9874E-05  0.0000E+00",
    "Q 48365.0  6 20100101 20120101  7.1614E-01  9.5683E-03 -7.7468E-05  0.0000E+00",
    "Q 48365.0  7 20100101 20120101  6.0981E-01  1.4882E-02 -1.2775E-04  0.0000E+00",
    "Q 48365.0  8 20100101 20120101  8.5292E-01  5.6786E-03 -5.1776E-05  0.0000E+00",
    "Q 48365.0  9 20100101 20120101  8.8352E-01  7.5604E-03 -9.0332E-05  0.0000E+00",
    "Q 48365.0 13 20100101 20120101  6.5269E-01  1.0693E-02 -6.6459E-05  0.0000E+00",
    "Q 48365.0 14 20100101 20120101  8.5673E-01  5.9990E-03 -6.1083E-05  0.0000E+00",
    "Q 48365.0 15 20100101 20120101  6.5793E-01  9.5072E-03 -4.5286E-05  0.0000E+00",
    "Q 48365.0 16 20100101 20120101  8.4935E-01  1.0241E-02 -1.1786E-04  0.0000E+00",
    "Q 48365.0 18 20100101 20120101  6.0036E-01  1.3031E-02 -9.3355E-05  0.0000E+00",
    "Q 48365.0 19 20100101 20120101  8.2409E-01  1.0470E-02 -1.2105E-04  0.0000E+00",
    "Q 48365.0 21 20100101 20120101  7.7819E-01  7.8023E-03 -5.8040E-05  0.0000E+00",
    "Q 48365.0 23 20100101 20120101  7.5737E-01  9.0718E-03 -7.3155E-05  0.0000E+00",
    "Q 48365.0 24 20100101 20120101  7.6426E-01  9.9001E-03 -7.7603E-05  0.0000E+00",
    "Q 48365.0 25 20100101 20120101  8.3456E-01  8.7760E-03 -9.4815E-05  0.0000E+00",
    "Q 48365.0 27 20100101 20120101  7.6934E-01  6.0024E-03 -2.9354E-05  0.0000E+00",
    "Q 48365.0  0 20100101 20120101  7.7480E-01  9.3018E-03 -8.3316E-05  0.0000E+00",
    /*;*/
    /*; X-band (8435 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "X  8435.0  1 20120101 21000101  6.9495E-03 -4.6754E-04  7.2637E-06  0.0000E+00",
    "X  8435.0  2 20120101 21000101  4.8241E-03 -3.2529E-04  5.0323E-06  0.0000E+00",
    "X  8435.0  3 20120101 21000101  3.6034E-03 -2.4306E-04  3.7557E-06  0.0000E+00",
    "X  8435.0  4 20120101 21000101  4.7182E-03 -3.1803E-04  4.9207E-06  0.0000E+00",
    "X  8435.0  6 20120101 21000101  9.9869E-03 -6.7406E-04  1.0421E-05  0.0000E+00",
    "X  8435.0  7 20120101 21000101  1.3243E-02 -8.9295E-04  1.3808E-05  0.0000E+00",
    "X  8435.0  8 20120101 21000101  4.9684E-03 -3.3544E-04  5.1745E-06  0.0000E+00",
    "X  8435.0  9 20120101 21000101  5.9689E-03 -4.0329E-04  6.2176E-06  0.0000E+00",
    "X  8435.0 10 20120101 21000101  5.0945E-03 -3.4349E-04  5.3119E-06  0.0000E+00",
    "X  8435.0 12 20120101 21000101  3.3557E-03 -2.2633E-04  3.4980E-06  0.0000E+00",
    "X  8435.0 13 20120101 21000101  9.3123E-03 -6.2908E-04  9.6937E-06  0.0000E+00",
    "X  8435.0 14 20120101 21000101  5.2542E-03 -3.5482E-04  5.4708E-06  0.0000E+00",
    "X  8435.0 15 20120101 21000101  9.9222E-03 -6.6237E-04  1.0424E-05  0.0000E+00",
    "X  8435.0 16 20120101 21000101  1.1181E-02 -7.5330E-04  1.1667E-05  0.0000E+00",
    "X  8435.0 17 20120101 21000101  3.2846E-03 -2.2162E-04  3.4227E-06  0.0000E+00",
    "X  8435.0 18 20120101 21000101  9.0588E-03 -6.0991E-04  9.4703E-06  0.0000E+00",
    "X  8435.0 19 20120101 21000101  7.2133E-03 -4.8699E-04  7.5126E-06  0.0000E+00",
    "X  8435.0 20 20120101 21000101  5.9221E-03 -3.9979E-04  6.1682E-06  0.0000E+00",
    "X  8435.0 21 20120101 21000101  6.1336E-03 -4.1465E-04  6.3797E-06  0.0000E+00",
    "X  8435.0 22 20120101 21000101  5.0601E-03 -3.4147E-04  5.2721E-06  0.0000E+00",
    "X  8435.0 23 20120101 21000101  4.9836E-03 -3.3640E-04  5.1911E-06  0.0000E+00",
    "X  8435.0 24 20120101 21000101  1.2343E-02 -8.3210E-04  1.2872E-05  0.0000E+00",
    "X  8435.0 25 20120101 21000101  6.6867E-03 -4.5066E-04  6.9751E-06  0.0000E+00",
    "X  8435.0 26 20120101 21000101  7.2917E-03 -4.9016E-04  7.6238E-06  0.0000E+00",
    "X  8435.0 27 20120101 21000101  2.6814E-03 -1.8106E-04  2.7921E-06  0.0000E+00",
    "X  8435.0  0 20120101 21000101  6.7616E-03 -4.5575E-04  7.0536E-06  0.0000E+00",
    /*;*/
    /*; X-band (8735 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "X  8735.0  1 20120101 21000101  1.3250E-02 -8.9319E-04  1.3848E-05  0.0000E+00",
    "X  8735.0  2 20120101 21000101  4.0996E-03 -2.7646E-04  4.2757E-06  0.0000E+00",
    "X  8735.0  3 20120101 21000101  3.5537E-03 -2.3970E-04  3.7041E-06  0.0000E+00",
    "X  8735.0  4 20120101 21000101  3.7730E-03 -2.5443E-04  3.9334E-06  0.0000E+00",
    "X  8735.0  6 20120101 21000101  5.8189E-03 -3.9308E-04  6.0606E-06  0.0000E+00",
    "X  8735.0  7 20120101 21000101  1.0883E-02 -7.3419E-04  1.1343E-05  0.0000E+00",
    "X  8735.0  8 20120101 21000101  4.6140E-03 -3.1155E-04  4.8048E-06  0.0000E+00",
    "X  8735.0  9 20120101 21000101  5.2468E-03 -3.5444E-04  5.4614E-06  0.0000E+00",
    "X  8735.0 10 20120101 21000101  7.0123E-03 -4.7247E-04  7.3162E-06  0.0000E+00",
    "X  8735.0 12 20120101 21000101  3.1298E-03 -2.1145E-04  3.2571E-06  0.0000E+00",
    "X  8735.0 13 20120101 21000101  1.4577E-02 -9.7946E-04  1.5237E-05  0.0000E+00",
    "X  8735.0 14 20120101 21000101  6.9923E-03 -4.7207E-04  7.2826E-06  0.0000E+00",
    "X  8735.0 15 20120101 21000101  5.4598E-03 -3.6903E-04  5.6848E-06  0.0000E+00",
    "X  8735.0 16 20120101 21000101  1.0706E-02 -7.1887E-04  1.1196E-05  0.0000E+00",
    "X  8735.0 17 20120101 21000101  3.0832E-03 -2.0804E-04  3.2126E-06  0.0000E+00",
    "X  8735.0 18 20120101 21000101  6.6507E-03 -4.4894E-04  6.9355E-06  0.0000E+00",
    "X  8735.0 19 20120101 21000101  6.6434E-03 -4.4851E-04  6.9194E-06  0.0000E+00",
    "X  8735.0 20 20120101 21000101  5.2188E-03 -3.5239E-04  5.4345E-06  0.0000E+00",
    "X  8735.0 21 20120101 21000101  5.9791E-03 -4.0278E-04  6.2430E-06  0.0000E+00",
    "X  8735.0 22 20120101 21000101  5.8784E-03 -3.9668E-04  6.1250E-06  0.0000E+00",
    "X  8735.0 23 20120101 21000101  7.3364E-03 -4.9510E-04  7.6439E-06  0.0000E+00",
    "X  8735.0 24 20120101 21000101  7.5011E-03 -5.0582E-04  7.8208E-06  0.0000E+00",
    "X  8735.0 25 20120101 21000101  6.7780E-03 -4.5676E-04  7.0708E-06  0.0000E+00",
    "X  8735.0 26 20120101 21000101  1.1765E-02 -7.9311E-04  1.2293E-05  0.0000E+00",
    "X  8735.0 27 20120101 21000101  2.9907E-03 -2.0190E-04  3.1149E-06  0.0000E+00",
    "X  8735.0  0 20120101 21000101  6.7576E-03 -4.5562E-04  7.0487E-06  0.0000E+00",
    /*;*/
    /*; U-band (11064 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "U 11064.0  6 20120101 21000101  8.4236E-03 -5.6006E-04  8.8424E-06  0.0000E+00",
    "U 11064.0  7 20120101 21000101  2.8083E-03 -1.8957E-04  2.9250E-06  0.0000E+00",
    "U 11064.0 10 20120101 21000101  1.1363E-02 -7.6659E-04  1.1844E-05  0.0000E+00",
    "U 11064.0 13 20120101 21000101  9.0850E-03 -6.0363E-04  9.5415E-06  0.0000E+00",
    "U 11064.0 14 20120101 21000101  8.3720E-03 -5.5357E-04  8.7986E-06  0.0000E+00",
    "U 11064.0 16 20120101 21000101  3.4635E-03 -2.3348E-04  3.6119E-06  0.0000E+00",
    "U 11064.0 17 20120101 21000101  1.7196E-02 -1.1604E-03  1.7921E-05  0.0000E+00",
    "U 11064.0 18 20120101 21000101  6.7330E-03 -4.5429E-04  7.0228E-06  0.0000E+00",
    "U 11064.0 19 20120101 21000101  2.9233E-03 -1.9746E-04  3.0430E-06  0.0000E+00",
    "U 11064.0 21 20120101 21000101  9.8753E-03 -6.5723E-04  1.0363E-05  0.0000E+00",
    "U 11064.0 23 20120101 21000101  2.9996E-03 -2.0247E-04  3.1246E-06  0.0000E+00",
    "U 11064.0 24 20120101 21000101  9.0741E-03 -6.0039E-04  9.5355E-06  0.0000E+00",
    "U 11064.0 25 20120101 21000101  1.6802E-02 -1.1338E-03  1.7510E-05  0.0000E+00",
    "U 11064.0  0 20120101 21000101  8.3937E-03 -5.6253E-04  8.7756E-06  0.0000E+00",
    /*;*/
    /*; U-band (14965 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "U 14965.0  5 20120101 21000101  1.3149E-02 -8.8729E-04  1.3703E-05  0.0000E+00",
    "U 14965.0  6 20120101 21000101  1.2895E-02 -8.5487E-04  1.3561E-05  0.0000E+00",
    "U 14965.0  7 20120101 21000101  1.0855E-02 -7.3212E-04  1.1317E-05  0.0000E+00",
    "U 14965.0 10 20120101 21000101  1.6210E-02 -1.0825E-03  1.6961E-05  0.0000E+00",
    "U 14965.0 12 20120101 21000101  9.8004E-03 -6.6151E-04  1.0210E-05  0.0000E+00",
    "U 14965.0 13 20120101 21000101  8.8328E-03 -5.8631E-04  9.2737E-06  0.0000E+00",
    "U 14965.0 14 20120101 21000101  1.7386E-02 -1.1740E-03  1.8108E-05  0.0000E+00",
    "U 14965.0 16 20120101 21000101  1.3952E-02 -9.3146E-04  1.4607E-05  0.0000E+00",
    "U 14965.0 17 20120101 21000101  6.2769E-03 -4.2407E-04  6.5330E-06  0.0000E+00",
    "U 14965.0 18 20120101 21000101  9.5118E-03 -6.3245E-04  1.0009E-05  0.0000E+00",
    "U 14965.0 19 20120101 21000101  1.5251E-02 -1.0296E-03  1.5886E-05  0.0000E+00",
    "U 14965.0 20 20120101 21000101  1.4294E-02 -9.5330E-04  1.5038E-05  0.0000E+00",
    "U 14965.0 21 20120101 21000101  4.2369E-03 -2.8589E-04  4.4172E-06  0.0000E+00",
    "U 14965.0 22 20120101 21000101  9.2521E-03 -6.1527E-04  9.7235E-06  0.0000E+00",
    "U 14965.0 23 20120101 21000101  1.1695E-02 -7.8500E-04  1.2219E-05  0.0000E+00",
    "U 14965.0 24 20120101 21000101  3.5060E-03 -2.3717E-04  3.6458E-06  0.0000E+00",
    "U 14965.0 25 20120101 21000101  1.1578E-02 -7.8136E-04  1.2064E-05  0.0000E+00",
    "U 14965.0  0 20120101 21000101  1.1099E-02 -7.4437E-04  1.1604E-05  0.0000E+00",
    /*;*/
    /*; U-band (17422 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "U 17422.0  5 20120101 21000101  9.7053E-03 -6.5497E-04  1.0112E-05  0.0000E+00",
    "U 17422.0  6 20120101 21000101  1.1629E-02 -7.7875E-04  1.2166E-05  0.0000E+00",
    "U 17422.0  7 20120101 21000101  1.1863E-02 -8.0053E-04  1.2362E-05  0.0000E+00",
    "U 17422.0 10 20120101 21000101  1.4929E-02 -1.0081E-03  1.5548E-05  0.0000E+00",
    "U 17422.0 12 20120101 21000101  1.0844E-02 -7.3194E-04  1.1298E-05  0.0000E+00",
    "U 17422.0 13 20120101 21000101  1.3686E-02 -9.1471E-04  1.4379E-05  0.0000E+00",
    "U 17422.0 14 20120101 21000101  1.3090E-02 -8.8385E-04  1.3633E-05  0.0000E+00",
    "U 17422.0 16 20120101 21000101  1.3450E-02 -9.0820E-04  1.4008E-05  0.0000E+00",
    "U 17422.0 17 20120101 21000101  9.9121E-03 -6.6046E-04  1.0400E-05  0.0000E+00",
    "U 17422.0 18 20120101 21000101  1.2096E-02 -7.9545E-04  1.2759E-05  0.0000E+00",
    "U 17422.0 19 20120101 21000101  9.2834E-03 -6.2682E-04  9.6681E-06  0.0000E+00",
    "U 17422.0 20 20120101 21000101  9.5768E-03 -6.4283E-04  1.0024E-05  0.0000E+00",
    "U 17422.0 21 20120101 21000101  1.1929E-02 -8.0021E-04  1.2503E-05  0.0000E+00",
    "U 17422.0 22 20120101 21000101  3.4634E-03 -2.3398E-04  3.6061E-06  0.0000E+00",
    "U 17422.0 23 20120101 21000101  1.1255E-02 -7.6060E-04  1.1712E-05  0.0000E+00",
    "U 17422.0 24 20120101 21000101  1.0904E-02 -7.3384E-04  1.1387E-05  0.0000E+00",
    "U 17422.0 25 20120101 21000101  1.1141E-02 -7.5180E-04  1.1609E-05  0.0000E+00",
    "U 17422.0  0 20120101 21000101  1.1103E-02 -7.4629E-04  1.1599E-05  0.0000E+00",
    /*;*/
    /*; K-band (22450 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "K 22450.0  1 20120101 21000101  1.0857E-02 -7.2689E-04  1.1397E-05  0.0000E+00",
    "K 22450.0  2 20120101 21000101  9.3067E-03 -6.2672E-04  9.7240E-06  0.0000E+00",
    "K 22450.0  3 20120101 21000101  3.1285E-03 -2.1141E-04  3.2563E-06  0.0000E+00",
    "K 22450.0  4 20120101 21000101  3.7196E-03 -2.5064E-04  3.8821E-06  0.0000E+00",
    "K 22450.0  5 20120101 21000101  9.1300E-03 -6.1339E-04  9.5524E-06  0.0000E+00",
    "K 22450.0  6 20120101 21000101  1.0307E-02 -6.8777E-04  1.0833E-05  0.0000E+00",
    "K 22450.0  7 20120101 21000101  1.3423E-02 -8.9945E-04  1.4038E-05  0.0000E+00",
    "K 22450.0  8 20120101 21000101  1.3905E-02 -9.2563E-04  1.4636E-05  0.0000E+00",
    "K 22450.0  9 20120101 21000101  1.3519E-02 -9.1037E-04  1.4139E-05  0.0000E+00",
    "K 22450.0 10 20120101 21000101  1.1744E-02 -7.9348E-04  1.2223E-05  0.0000E+00",
    "K 22450.0 12 20120101 21000101  1.1690E-02 -7.8939E-04  1.2175E-05  0.0000E+00",
    "K 22450.0 13 20120101 21000101  4.3006E-03 -2.9081E-04  4.4745E-06  0.0000E+00",
    "K 22450.0 14 20120101 21000101  1.3923E-02 -9.3673E-04  1.4570E-05  0.0000E+00",
    "K 22450.0 15 20120101 21000101  1.0968E-02 -7.3691E-04  1.1482E-05  0.0000E+00",
    "K 22450.0 16 20120101 21000101  8.5849E-03 -5.7704E-04  8.9786E-06  0.0000E+00",
    "K 22450.0 17 20120101 21000101  1.0080E-02 -6.8092E-04  1.0506E-05  0.0000E+00",
    "K 22450.0 18 20120101 21000101  1.7570E-02 -1.1828E-03  1.8387E-05  0.0000E+00",
    "K 22450.0 19 20120101 21000101  1.0862E-02 -7.2816E-04  1.1358E-05  0.0000E+00",
    "K 22450.0 20 20120101 21000101  5.5257E-03 -3.7167E-04  5.7765E-06  0.0000E+00",
    "K 22450.0 21 20120101 21000101  1.2567E-02 -8.3678E-04  1.3213E-05  0.0000E+00",
    "K 22450.0 22 20120101 21000101  1.0833E-02 -7.2939E-04  1.1325E-05  0.0000E+00",
    "K 22450.0 23 20120101 21000101  1.0142E-02 -6.8363E-04  1.0592E-05  0.0000E+00",
    "K 22450.0 24 20120101 21000101  1.2396E-02 -8.2304E-04  1.3057E-05  0.0000E+00",
    "K 22450.0 26 20120101 21000101  1.4062E-02 -9.4245E-04  1.4750E-05  0.0000E+00",
    "K 22450.0 27 20120101 21000101  6.7413E-03 -4.5078E-04  7.0616E-06  0.0000E+00",
    "K 22450.0  0 20120101 21000101  1.0371E-02 -6.9625E-04  1.0855E-05  0.0000E+00",
    /*;*/
    /*; K-band (25836 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "K 25836.0  1 20120101 21000101  7.6262E-03 -5.1338E-04  7.9705E-06  0.0000E+00",
    "K 25836.0  2 20120101 21000101  1.1358E-02 -7.6478E-04  1.1876E-05  0.0000E+00",
    "K 25836.0  3 20120101 21000101  1.2003E-02 -8.0863E-04  1.2552E-05  0.0000E+00",
    "K 25836.0  4 20120101 21000101  6.8970E-03 -4.6528E-04  7.1967E-06  0.0000E+00",
    "K 25836.0  5 20120101 21000101  6.5256E-03 -4.4102E-04  6.7957E-06  0.0000E+00",
    "K 25836.0  6 20120101 21000101  7.1352E-03 -4.8204E-04  7.4317E-06  0.0000E+00",
    "K 25836.0  7 20120101 21000101  1.0226E-02 -6.9073E-04  1.0646E-05  0.0000E+00",
    "K 25836.0  8 20120101 21000101  8.5690E-03 -5.7709E-04  8.9541E-06  0.0000E+00",
    "K 25836.0  9 20120101 21000101  8.9571E-03 -6.0148E-04  9.3794E-06  0.0000E+00",
    "K 25836.0 10 20120101 21000101  6.5613E-03 -4.4331E-04  6.8287E-06  0.0000E+00",
    "K 25836.0 12 20120101 21000101  8.9131E-03 -6.0182E-04  9.2824E-06  0.0000E+00",
    "K 25836.0 13 20120101 21000101  4.0386E-03 -2.7311E-04  4.2014E-06  0.0000E+00",
    "K 25836.0 14 20120101 21000101  1.2400E-02 -8.3622E-04  1.2951E-05  0.0000E+00",
    "K 25836.0 15 20120101 21000101  1.2473E-02 -8.3988E-04  1.3041E-05  0.0000E+00",
    "K 25836.0 16 20120101 21000101  8.3023E-03 -5.6084E-04  8.6522E-06  0.0000E+00",
    "K 25836.0 17 20120101 21000101  8.9674E-03 -6.0405E-04  9.3680E-06  0.0000E+00",
    "K 25836.0 18 20120101 21000101  9.9824E-03 -6.7116E-04  1.0451E-05  0.0000E+00",
    "K 25836.0 19 20120101 21000101  8.5482E-03 -5.7315E-04  8.9477E-06  0.0000E+00",
    "K 25836.0 20 20120101 21000101  6.7857E-03 -4.5840E-04  7.0692E-06  0.0000E+00",
    "K 25836.0 21 20120101 21000101  1.2936E-02 -8.6361E-04  1.3597E-05  0.0000E+00",
    "K 25836.0 22 20120101 21000101  1.3278E-02 -8.9097E-04  1.3920E-05  0.0000E+00",
    "K 25836.0 23 20120101 21000101  7.7336E-03 -5.2105E-04  8.0755E-06  0.0000E+00",
    "K 25836.0 24 20120101 21000101  1.2033E-02 -8.0500E-04  1.2635E-05  0.0000E+00",
    "K 25836.0 26 20120101 21000101  3.1429E-03 -2.1232E-04  3.2725E-06  0.0000E+00",
    "K 25836.0 27 20120101 21000101  1.3074E-02 -8.8223E-04  1.3642E-05  0.0000E+00",
    "K 25836.0  0 20120101 21000101  9.1387E-03 -6.1526E-04  9.5494E-06  0.0000E+00",
    /*;*/
    /*; A-band (28450 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "A 28450.0  2 20120101 21000101  5.8836E-03 -3.9765E-04  6.1262E-06  0.0000E+00",
    "A 28450.0  3 20120101 21000101  8.1469E-03 -5.4987E-04  8.4963E-06  0.0000E+00",
    "A 28450.0  4 20120101 21000101  8.7347E-03 -5.8693E-04  9.1421E-06  0.0000E+00",
    "A 28450.0  5 20120101 21000101  5.7551E-03 -3.8885E-04  5.9893E-06  0.0000E+00",
    "A 28450.0  6 20120101 21000101  6.2773E-03 -4.2191E-04  6.5679E-06  0.0000E+00",
    "A 28450.0  7 20120101 21000101  7.9849E-03 -5.3885E-04  8.3284E-06  0.0000E+00",
    "A 28450.0  8 20120101 21000101  8.4027E-03 -5.6541E-04  8.7851E-06  0.0000E+00",
    "A 28450.0  9 20120101 21000101  8.8121E-03 -5.9385E-04  9.2023E-06  0.0000E+00",
    "A 28450.0 10 20120101 21000101  9.6404E-03 -6.4930E-04  1.0074E-05  0.0000E+00",
    "A 28450.0 12 20120101 21000101  8.0194E-03 -5.3892E-04  8.3926E-06  0.0000E+00",
    "A 28450.0 13 20120101 21000101  7.5846E-03 -5.1242E-04  7.8983E-06  0.0000E+00",
    "A 28450.0 14 20120101 21000101  7.8289E-03 -5.2731E-04  8.1784E-06  0.0000E+00",
    "A 28450.0 15 20120101 21000101  6.2168E-03 -4.1955E-04  6.4820E-06  0.0000E+00",
    "A 28450.0 16 20120101 21000101  7.0984E-03 -4.7906E-04  7.3956E-06  0.0000E+00",
    "A 28450.0 17 20120101 21000101  6.1296E-03 -4.1403E-04  6.3809E-06  0.0000E+00",
    "A 28450.0 18 20120101 21000101  7.2165E-03 -4.8589E-04  7.5396E-06  0.0000E+00",
    "A 28450.0 19 20120101 21000101  1.4836E-02 -9.9684E-04  1.5503E-05  0.0000E+00",
    "A 28450.0 20 20120101 21000101  6.4254E-03 -4.3258E-04  6.7111E-06  0.0000E+00",
    "A 28450.0 21 20120101 21000101  7.0893E-03 -4.7035E-04  7.4574E-06  0.0000E+00",
    "A 28450.0 22 20120101 21000101  1.5170E-02 -1.0232E-03  1.5846E-05  0.0000E+00",
    "A 28450.0 23 20120101 21000101  7.3779E-03 -4.9482E-04  7.7284E-06  0.0000E+00",
    "A 28450.0 24 20120101 21000101  9.3240E-03 -6.2711E-04  9.7533E-06  0.0000E+00",
    "A 28450.0 25 20120101 21000101  9.1361E-03 -6.1308E-04  9.5749E-06  0.0000E+00",
    "A 28450.0 26 20120101 21000101  8.8920E-03 -5.9648E-04  9.3152E-06  0.0000E+00",
    "A 28450.0 27 20120101 21000101  6.7650E-03 -4.5463E-04  7.0716E-06  0.0000E+00",
    "A 28450.0  0 20120101 21000101  8.1899E-03 -5.5115E-04  8.5576E-06  0.0000E+00",
    /*;*/
    /*; A-band (36435 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "A 36435.0  2 20120101 21000101  3.3719E-03 -2.2793E-04  3.5089E-06  0.0000E+00",
    "A 36435.0  3 20120101 21000101  4.5439E-03 -3.0672E-04  4.7357E-06  0.0000E+00",
    "A 36435.0  4 20120101 21000101  1.0071E-02 -6.8003E-04  1.0502E-05  0.0000E+00",
    "A 36435.0  5 20120101 21000101  3.1980E-03 -2.1605E-04  3.3284E-06  0.0000E+00",
    "A 36435.0  6 20120101 21000101  1.0706E-02 -7.2223E-04  1.1179E-05  0.0000E+00",
    "A 36435.0  7 20120101 21000101  4.1485E-03 -2.8043E-04  4.3176E-06  0.0000E+00",
    "A 36435.0  8 20120101 21000101  4.1656E-03 -2.8170E-04  4.3336E-06  0.0000E+00",
    "A 36435.0  9 20120101 21000101  5.7741E-03 -3.9029E-04  6.0114E-06  0.0000E+00",
    "A 36435.0 10 20120101 21000101  5.0271E-03 -3.3927E-04  5.2405E-06  0.0000E+00",
    "A 36435.0 12 20120101 21000101  5.0796E-03 -3.4346E-04  5.2860E-06  0.0000E+00",
    "A 36435.0 13 20120101 21000101  4.2595E-03 -2.8782E-04  4.4324E-06  0.0000E+00",
    "A 36435.0 14 20120101 21000101  4.7022E-03 -3.1712E-04  4.9046E-06  0.0000E+00",
    "A 36435.0 15 20120101 21000101  3.5209E-03 -2.3807E-04  3.6631E-06  0.0000E+00",
    "A 36435.0 16 20120101 21000101  3.9532E-03 -2.6680E-04  4.1183E-06  0.0000E+00",
    "A 36435.0 17 20120101 21000101  4.8896E-03 -3.3036E-04  5.0887E-06  0.0000E+00",
    "A 36435.0 18 20120101 21000101  4.1945E-03 -2.8363E-04  4.3639E-06  0.0000E+00",
    "A 36435.0 19 20120101 21000101  9.7540E-03 -6.5639E-04  1.0183E-05  0.0000E+00",
    "A 36435.0 20 20120101 21000101  4.6217E-03 -3.1248E-04  4.8099E-06  0.0000E+00",
    "A 36435.0 21 20120101 21000101  1.2506E-02 -8.4349E-04  1.3061E-05  0.0000E+00",
    "A 36435.0 22 20120101 21000101  1.3967E-02 -9.4175E-04  1.4591E-05  0.0000E+00",
    "A 36435.0 23 20120101 21000101  4.6713E-03 -3.1590E-04  4.8597E-06  0.0000E+00",
    "A 36435.0 24 20120101 21000101  4.4447E-03 -2.9999E-04  4.6328E-06  0.0000E+00",
    "A 36435.0 25 20120101 21000101  9.5798E-03 -6.3972E-04  1.0064E-05  0.0000E+00",
    "A 36435.0 26 20120101 21000101  5.0495E-03 -3.4114E-04  5.2588E-06  0.0000E+00",
    "A 36435.0 27 20120101 21000101  4.4947E-03 -3.0380E-04  4.6772E-06  0.0000E+00",
    "A 36435.0  0 20120101 21000101  6.0278E-03 -4.0666E-04  6.2860E-06  0.0000E+00",
    /*;*/
    /*; Q-band (43340 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "Q 43340.0  1 20120101 21000101  1.2002E-02 -8.0334E-04  1.2597E-05  0.0000E+00",
    "Q 43340.0  2 20120101 21000101  5.0847E-03 -3.4362E-04  5.2937E-06  0.0000E+00",
    "Q 43340.0  3 20120101 21000101  1.5150E-02 -1.0138E-03  1.5907E-05  0.0000E+00",
    "Q 43340.0  4 20120101 21000101  4.7999E-03 -3.2446E-04  4.9957E-06  0.0000E+00",
    "Q 43340.0  5 20120101 21000101  3.1760E-03 -2.1473E-04  3.3045E-06  0.0000E+00",
    "Q 43340.0  6 20120101 21000101  8.9081E-03 -5.9225E-04  9.3540E-06  0.0000E+00",
    "Q 43340.0  7 20120101 21000101  5.6982E-03 -3.8525E-04  5.9308E-06  0.0000E+00",
    "Q 43340.0  8 20120101 21000101  5.5720E-03 -3.7649E-04  5.8022E-06  0.0000E+00",
    "Q 43340.0  9 20120101 21000101  4.3478E-03 -2.9402E-04  4.5232E-06  0.0000E+00",
    "Q 43340.0 10 20120101 21000101  3.3480E-03 -2.2632E-04  3.4834E-06  0.0000E+00",
    "Q 43340.0 12 20120101 21000101  3.2976E-03 -2.2294E-04  3.4313E-06  0.0000E+00",
    "Q 43340.0 13 20120101 21000101  5.6186E-03 -3.7983E-04  5.8480E-06  0.0000E+00",
    "Q 43340.0 14 20120101 21000101  8.2823E-03 -5.5577E-04  8.6746E-06  0.0000E+00",
    "Q 43340.0 15 20120101 21000101  1.4464E-02 -9.6204E-04  1.5207E-05  0.0000E+00",
    "Q 43340.0 16 20120101 21000101  3.3506E-03 -2.2643E-04  3.4870E-06  0.0000E+00",
    "Q 43340.0 17 20120101 21000101  2.9686E-03 -2.0045E-04  3.0919E-06  0.0000E+00",
    "Q 43340.0 18 20120101 21000101  4.5686E-03 -3.0856E-04  4.7584E-06  0.0000E+00",
    "Q 43340.0 19 20120101 21000101  3.4130E-03 -2.3075E-04  3.5506E-06  0.0000E+00",
    "Q 43340.0 20 20120101 21000101  3.6801E-03 -2.4893E-04  3.8270E-06  0.0000E+00",
    "Q 43340.0 21 20120101 21000101  3.7449E-03 -2.5256E-04  3.9056E-06  0.0000E+00",
    "Q 43340.0 22 20120101 21000101  8.2101E-03 -5.5253E-04  8.5819E-06  0.0000E+00",
    "Q 43340.0 23 20120101 21000101  2.5010E-03 -1.6894E-04  2.6040E-06  0.0000E+00",
    "Q 43340.0 24 20120101 21000101  3.3878E-03 -2.2910E-04  3.5239E-06  0.0000E+00",
    "Q 43340.0 25 20120101 21000101  5.9717E-03 -4.0320E-04  6.2232E-06  0.0000E+00",
    "Q 43340.0 26 20120101 21000101  8.5947E-03 -5.7829E-04  8.9847E-06  0.0000E+00",
    "Q 43340.0 27 20120101 21000101  3.6930E-03 -2.4966E-04  3.8410E-06  0.0000E+00",
    "Q 43340.0  0 20120101 21000101  5.9167E-03 -3.9786E-04  6.1820E-06  0.0000E+00",
    /*;*/
    /*; Q-band (48425 MHz) gains from flux density run in January 2012.*/
    /*;*/
    "Q 48425.0  1 20120101 21000101  2.9080E-03 -1.9667E-04  3.0243E-06  0.0000E+00",
    "Q 48425.0  2 20120101 21000101  3.1859E-03 -2.1520E-04  3.3171E-06  0.0000E+00",
    "Q 48425.0  3 20120101 21000101  5.5611E-03 -3.7572E-04  5.7919E-06  0.0000E+00",
    "Q 48425.0  4 20120101 21000101  4.1547E-03 -2.8074E-04  4.3255E-06  0.0000E+00",
    "Q 48425.0  5 20120101 21000101  1.0706E-02 -7.1630E-04  1.1240E-05  0.0000E+00",
    "Q 48425.0  6 20120101 21000101  1.3932E-02 -9.2475E-04  1.4669E-05  0.0000E+00",
    "Q 48425.0  7 20120101 21000101  3.9846E-03 -2.6933E-04  4.1472E-06  0.0000E+00",
    "Q 48425.0  8 20120101 21000101  4.1916E-03 -2.8349E-04  4.3597E-06  0.0000E+00",
    "Q 48425.0  9 20120101 21000101  3.8023E-03 -2.5703E-04  3.9571E-06  0.0000E+00",
    "Q 48425.0 10 20120101 21000101  3.6468E-03 -2.4663E-04  3.7933E-06  0.0000E+00",
    "Q 48425.0 12 20120101 21000101  1.7415E-02 -1.1617E-03  1.8279E-05  0.0000E+00",
    "Q 48425.0 13 20120101 21000101  5.4464E-03 -3.6757E-04  5.6771E-06  0.0000E+00",
    "Q 48425.0 14 20120101 21000101  3.8325E-03 -2.5841E-04  3.9972E-06  0.0000E+00",
    "Q 48425.0 15 20120101 21000101  1.1726E-02 -7.8760E-04  1.2275E-05  0.0000E+00",
    "Q 48425.0 16 20120101 21000101  9.2201E-03 -6.1312E-04  9.6810E-06  0.0000E+00",
    "Q 48425.0 17 20120101 21000101  3.6835E-03 -2.4865E-04  3.8381E-06  0.0000E+00",
    "Q 48425.0 18 20120101 21000101  9.6602E-03 -6.5099E-04  1.0096E-05  0.0000E+00",
    "Q 48425.0 19 20120101 21000101  8.1917E-03 -5.4603E-04  8.5943E-06  0.0000E+00",
    "Q 48425.0 20 20120101 21000101  3.0375E-03 -2.0539E-04  3.1593E-06  0.0000E+00",
    "Q 48425.0 21 20120101 21000101  1.6104E-02 -1.0808E-03  1.6882E-05  0.0000E+00",
    "Q 48425.0 22 20120101 21000101  1.0738E-02 -7.2265E-04  1.1231E-05  0.0000E+00",
    "Q 48425.0 23 20120101 21000101  1.3195E-02 -8.8341E-04  1.3846E-05  0.0000E+00",
    "Q 48425.0 24 20120101 21000101  8.1395E-03 -5.4311E-04  8.5508E-06  0.0000E+00",
    "Q 48425.0 25 20120101 21000101  3.8193E-03 -2.5754E-04  3.9834E-06  0.0000E+00",
    "Q 48425.0 26 20120101 21000101  3.6479E-03 -2.4593E-04  3.8054E-06  0.0000E+00",
    "Q 48425.0 27 20120101 21000101  2.7289E-03 -1.8443E-04  2.8397E-06  0.0000E+00",
    "Q 48425.0  0 20120101 21000101  7.1791E-03 -4.8166E-04  7.5139E-06  0.0000E+00",
    NULL
  };
  /* Number of bands tabulated */
  olong nband=10;
  /* Band codes in Table */
  gchar BandCode[] = {'4', 'P', 'L', 'S', 'C', 'X', 'U', 'K', 'A', 'Q'};
  /* Upper frequency of bands in BandCodes */
  odouble tfreq;
  odouble upFreq[] = 
    /*  4        P      L       S      C       X      U        K       A      Q */
    {100.0e6, 900.0e6, 2.0e9, 3.7e9, 7.5e9, 12.0e9, 18.0e9, 26.5e9, 40.0e9, 50.0e9};

  /* Lookup band code */
  band = BandCode[0];
  for (i=0; i<nband; i++) {
    band = BandCode[i];
    if (Freq<upFreq[i]) break;
  }
  
  /* Make temp gain array */
  garray = g_malloc0(8*sizeof(ofloat*));
  for (i=0; i<8; i++) garray[i] = g_malloc0(4*sizeof(ofloat));

  /* Convert JD to data string */
  ObitUVDescJD2Date (JD, datestr);
  /* check */
  if (strncmp(datestr, "BAD DATE", 8)) {
    /* parse date */
    datestr[4] = ' '; datestr[7] = ' ';  /* remove '-' */
    n = sscanf (datestr, "%4d%3d%3d", &yr, &mo, &day);
    
  } else {  /* having a bad day - make it April 1, 2010 */
    yr  = 2010;
    mo  = 4;
    day = 1;
  }
  /* Put together test integer */
  date = yr*10000 + mo*100. + day;

  /*          1         2         3         4         5         6         7         */
  /*01234567890123456789012345678901234567890123456789012345678901234567890123456789*/
  /*Q 48425.0  0 20120101 21000101  7.1791E-03 -4.8166E-04  7.5139E-06  0.0000E+00*/
  /* Loop through table */
  iline   = 0;
  found   = FALSE;
  gotBand = FALSE;
  while (gainLines[iline]) {
    line = gainLines[iline];
    /* Band too far? */
    if ((line[0]!=band) && gotBand) break;
    /* correct band? */
    else if (line[0]!=band) {iline++; continue;}
    /* right band */
    gotBand = TRUE;

    /* Parse antenna, start and end dates for line */
    n = sscanf(&line[1], "%lf %d %d %d", &tfreq, &antno, &sdate, &edate);
    /* New frequency? */
    if ((iarray<0) || (farray[iarray]<=0.0)) {
      iarray++;
      narray++;
      farray[iarray] = tfreq;
      /* Use default? */
      if ((narray>1) && (garray[iarray][0]<=0.0)) {
	garray[iarray][0] = avgGain[0];
	garray[iarray][1] = avgGain[1];
	garray[iarray][2] = avgGain[2];
	garray[iarray][3] = avgGain[3];
	/* Still undefined? use flat */
	if (garray[iarray][0]<=0.0) {
	  garray[iarray][0] = 1.0;
	  garray[iarray][1] = 0.0;
	  garray[iarray][2] = 0.0;
	  garray[iarray][3] = 0.0;
	}
      }
      avgGain[0] = avgGain[1] = avgGain[2] = avgGain[3] = 0.0;
    }
      
    /* Save average parameters */
    if (antno==0) {
      /* parse reference ant values */
      n = sscanf(&line[30], "%f %f %f %f", 
		 &avgGain[0], &avgGain[1], &avgGain[2], &avgGain[3]);
    }  /* end average antenna */

    /* Start past JD? */
    if (sdate>date) break;
    /* Right antenna and In range? */
    if ((Ant==antno) && (date>sdate) && (date<edate)) {
      /* Got it */
      found = TRUE;
      /* parse coefficients */
      n = sscanf(&line[30], "%f %f %f %f", 
		 &garray[iarray][0], &garray[iarray][1], 
		 &garray[iarray][2], &garray[iarray][3]);
    }
    iline++;    /* next entry */
  } /* end loop over table */

  /* Use default for last gain? */
  if ((narray>=1) && (garray[iarray][0]<=0.0)) {
    garray[iarray][0] = avgGain[0];
    garray[iarray][1] = avgGain[1];
    garray[iarray][2] = avgGain[2];
    garray[iarray][3] = avgGain[3];
    /* Still undefined? use flat */
    if (garray[iarray][0]<=0.0) {
      garray[iarray][0] = 1.0;
      garray[iarray][1] = 0.0;
      garray[iarray][2] = 0.0;
      garray[iarray][3] = 0.0;
    }
  }

  /* Get interpolated curves */
  if (narray>=1) {
    /* have gain curves */
    GetGainCurves (4, narray, farray, garray, nfreq, gainFreq, gain);
  } else {
    /* Nothing - use flat curves */
    for (i=0; i<nfreq; i++) {
      gain[i][0] = 1.0;
      gain[i][1] = gain[i][2] = gain[i][3] = 0.0;
    }
  }

  /* Cleanup */
  if (garray) {
    for (i=0; i<8; i++) if (garray[i]) g_free(garray[i]);
    g_free(garray);
  }
} /* end ObitVLAGainParseGain */
