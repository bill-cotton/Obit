<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ObitSpectrumFit.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>ObitSpectrumFit.c File Reference</h1><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> class function definitions. <a href="#_details">More...</a>
<p>
<code>#include "<a class="el" href="ObitSpectrumFit_8h-source.html">ObitSpectrumFit.h</a>"</code><br>
<code>#include "<a class="el" href="ObitThread_8h-source.html">ObitThread.h</a>"</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNLFitArg.html">NLFitArg</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a3">ObitSpectrumFitInit</a> (gpointer in)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Private: Initialize newly instantiated object.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a4">ObitSpectrumFitClear</a> (gpointer in)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Private: Deallocate members.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a11">newObitSpectrumFit</a> (gchar *name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Default Constructor.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">gconstpointer&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a12">ObitSpectrumFitGetClass</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: ClassInfo pointer.  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a13">ObitSpectrumFitCopy</a> (<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *in, <a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *out, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Copy (deep) constructor.  <a href="#a13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a14">ObitSpectrumFitClone</a> (<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *in, <a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *out, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Copy structure.  <a href="#a14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a15">ObitSpectrumFitCreate</a> (gchar *name, <a class="el" href="ObitTypes_8h.html#a5">olong</a> nterm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Create/initialize <a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> structures.  <a href="#a15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a16">ObitSpectrumFitCube</a> (<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *in, <a class="el" href="structObitImage.html">ObitImage</a> *inImage, <a class="el" href="structObitImage.html">ObitImage</a> *outImage, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Fit spectrum to an image cube.  <a href="#a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a17">ObitSpectrumFitImArr</a> (<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *in, <a class="el" href="ObitTypes_8h.html#a5">olong</a> nimage, <a class="el" href="structObitImage.html">ObitImage</a> **imArr, <a class="el" href="structObitImage.html">ObitImage</a> *outImage, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Fit spectrum to an array of images.  <a href="#a17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a18">ObitSpectrumFitEval</a> (<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *in, <a class="el" href="structObitImage.html">ObitImage</a> *inImage, <a class="el" href="ObitTypes_8h.html#a7">odouble</a> outFreq, <a class="el" href="structObitImage.html">ObitImage</a> *outImage, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Evaluate spectrum.  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="ObitTypes_8h.html#a6">ofloat</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a19">ObitSpectrumFitSingle</a> (<a class="el" href="ObitTypes_8h.html#a5">olong</a> nfreq, <a class="el" href="ObitTypes_8h.html#a5">olong</a> nterm, <a class="el" href="ObitTypes_8h.html#a7">odouble</a> refFreq, <a class="el" href="ObitTypes_8h.html#a7">odouble</a> *freq, <a class="el" href="ObitTypes_8h.html#a6">ofloat</a> *flux, <a class="el" href="ObitTypes_8h.html#a6">ofloat</a> *sigma, gboolean doBrokePow, <a class="el" href="structObitErr.html">ObitErr</a> *err)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Fit single spectrum.  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ObitSpectrumFit_8c.html#a20">ObitSpectrumFitClassInit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Public: Class initializer.  <a href="#a20"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> class function definitions. 
<p>
This class is derived from the <a class="el" href="structObit.html">Obit</a> base class.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a11" doxytag="ObitSpectrumFit.c::newObitSpectrumFit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a>* newObitSpectrumFit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">gchar *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Default Constructor. 
<p>
Initializes class if needed on first call. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>An optional name for the object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the new object. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ObitSpectrumFit.c::ObitSpectrumFitClassInit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitClassInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Class initializer. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ObitSpectrumFit.c::ObitSpectrumFitClear"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitClear           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">gpointer&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>inn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Private: Deallocate members. 
<p>
Does (recursive) deallocation of parent class members. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inn</em>&nbsp;</td><td>Pointer to the object to deallocate. Actually it should be an ObitSpectrumFit* cast to an Obit*. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ObitSpectrumFit.c::ObitSpectrumFitClone"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitClone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Copy structure. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>The object to copy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>An existing object pointer for output, must be defined. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ObitSpectrumFit.c::ObitSpectrumFitCopy"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a>* ObitSpectrumFitCopy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Copy (deep) constructor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>The object to copy </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>An existing object pointer for output or NULL if none exists. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the new object. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ObitSpectrumFit.c::ObitSpectrumFitCreate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a>* ObitSpectrumFitCreate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">gchar *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a5">olong</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nterm</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Create/initialize <a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> structures. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>An optional name for the object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nterm</em>&nbsp;</td><td>Number of coefficients of powers of log(nu) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the new object. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ObitSpectrumFit.c::ObitSpectrumFitCube"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitCube           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>outImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Fit spectrum to an image cube. 
<p>
The third axis of the output image will be "SPECLOGF" to indicate that then planes are spectral fit parameters. The "CRVAL" on this axis will be the reference Frequency for the fitting. Item "NTERM" is added to the output image descriptor to give the maximum number Item ""BROKENPO" is added to the output image descriptor if fit is a broken power law of terms fitted <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Spectral fitting object Potential parameters on in-&gt;info: <ul>
<li>"refFreq" OBIT_double scalar Reference frequency for fit [def ref for inImage] </li>
<li>"maxChi2" OBIT_float scalar Max. Chi Sq for accepting a partial spectrum [def 1.5] </li>
<li>"doError" OBIT_boolean scalar If true do error analysis [def False] </li>
<li>"doPBCor" OBIT_boolean scalar If true do primary beam correction. [def False] </li>
<li>"doBrokePow" OBIT_boolean scalar If true do broken power law (3 terms). [def False] </li>
<li>"calFract" OBIT_float (?,1,1) Calibration error as fraction of flux One per frequency or one for all, def 1.0e-5 </li>
<li>"PBmin" OBIT_float (?,1,1) Minimum beam gain correction One per frequency or one for all, def 0.05, 1.0 =&gt; no gain corrections </li>
<li>"antSize" OBIT_float (?,1,1) Antenna diameter (m) for gain corr, One per frequency or one for all, def 25.0</li>
</ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inImage</em>&nbsp;</td><td>Image cube to be fitted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outImage</em>&nbsp;</td><td>Image cube with fitted spectra. Should be defined but not created. Planes 1-&gt;nterm are coefficients per pixel if doError: Planes nterm+1-&gt;2*nterm are uncertainties in coefficients Plane 2*nterm+1 = Chi squared of fit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ObitSpectrumFit.c::ObitSpectrumFitEval"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitEval           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>inImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a7">odouble</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>outFreq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>outImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Evaluate spectrum. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Spectral fitting object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>inImage</em>&nbsp;</td><td>Spectral coefficient image Planes 1-&gt;nterm are coefficients per pixel Planes nterm+1-&gt;2*nterm are uncertainties in coefficients Plane 2*nterm+1 = Chi squared of fit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outFreq</em>&nbsp;</td><td>Output Frequency in Hz </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outImage</em>&nbsp;</td><td>Image to write, must be defined but not yet exist. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ObitSpectrumFit.c::ObitSpectrumFitGetClass"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">gconstpointer ObitSpectrumFitGetClass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: ClassInfo pointer. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the class structure. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ObitSpectrumFit.c::ObitSpectrumFitImArr"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitImArr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structObitSpectrumFit.html">ObitSpectrumFit</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a5">olong</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nimage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>imArr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitImage.html">ObitImage</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>outImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Fit spectrum to an array of images. 
<p>
The "CRVAL" on this axis will be the reference Frequency for the fitting. Item "NTERM" is added to the output image descriptor to give the maximum number of terms fitted Item ""BROKENPO" is added to the output image descriptor if fit is a broken power law <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Spectral fitting object <ul>
<li>"refFreq" OBIT_double scalar Reference frequency for fit [def average of inputs] </li>
<li>"maxChi2" OBIT_float scalar Max. Chi Sq for accepting a partial spectrum [def 1.5] </li>
<li>"doError" OBIT_boolean scalar If true do error analysis [def False] </li>
<li>"doPBCor" OBIT_boolean scalar If true do primary beam correction.[def False] </li>
<li>"doBrokePow" OBIT_boolean scalar If true do broken power law (3 terms). [def False] </li>
<li>"calFract" OBIT_float (?,1,1) Calibration error as fraction of flux One per frequency or one for all, def 0.05 </li>
<li>"PBmin" OBIT_float (?,1,1) Minimum beam gain correction One per frequency or one for all, def 0.05, 1.0 =&gt; no gain corrections </li>
<li>"antSize" OBIT_float (?,1,1) Antenna diameter (m) for gain corr, One per frequency or one for all, def 25.0 </li>
</ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nimage</em>&nbsp;</td><td>Number of entries in imArr </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>imArr</em>&nbsp;</td><td>Array of images to be fitted </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outImage</em>&nbsp;</td><td>Image cube with fitted spectra. Should be defined but not created. Planes 1-&gt;nterm are coefficients per pixel if doError: Planes nterm+1-&gt;2*nterm are uncertainties in coefficients Plane 2*nterm+1 = Chi squared of fit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ObitSpectrumFit.c::ObitSpectrumFitInit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ObitSpectrumFitInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">gpointer&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>inn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Private: Initialize newly instantiated object. 
<p>
Parent classes portions are (recursively) initialized first <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inn</em>&nbsp;</td><td>Pointer to the object to initialize. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ObitSpectrumFit.c::ObitSpectrumFitSingle"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="ObitTypes_8h.html#a6">ofloat</a>* ObitSpectrumFitSingle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="ObitTypes_8h.html#a5">olong</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nfreq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a5">olong</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>nterm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a7">odouble</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>refFreq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a7">odouble</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>freq</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a6">ofloat</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>flux</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="ObitTypes_8h.html#a6">ofloat</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>gboolean&nbsp;</td>
          <td class="mdname" nowrap> <em>doBrokePow</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structObitErr.html">ObitErr</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>err</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Public: Fit single spectrum. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nfreq</em>&nbsp;</td><td>Number of entries in freq, flux, sigma </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nterm</em>&nbsp;</td><td>Number of coefficients of powers of log(nu) to fit </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>refFreq</em>&nbsp;</td><td>Reference frequency (Hz) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>freq</em>&nbsp;</td><td>Array of Frequencies (Hz) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flux</em>&nbsp;</td><td>Array of fluxes (Jy) same dim as freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sigma</em>&nbsp;</td><td>Array of errors (Jy) same dim as freq </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>doBrokePow</em>&nbsp;</td><td>TRUE if a broken power law fit is desired (3 terms) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td><a class="el" href="structObit.html">Obit</a> error stack object. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Array of fitter parameters, errors for each and Chi Squares of fit Initial terms are in Jy, other in log. </dd></dl>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jul 20 08:52:40 2009 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
