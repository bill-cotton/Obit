\section{Obit\-Sky\-Geom.h File Reference}
\label{ObitSkyGeom_8h}\index{ObitSkyGeom.h@{ObitSkyGeom.h}}
Celestial coordinates utility module. 

{\tt \#include \char`\"{}Obit.h\char`\"{}}\par
{\tt \#include \char`\"{}Obit\-Err.h\char`\"{}}\par
\subsection*{Enumerations}
\begin{CompactItemize}
\item 
enum {\bf obit\-Sky\-Geom\-Proj} \{ \par
{\bf OBIT\_\-Sky\-Geom\_\-SIN} =  0, 
{\bf OBIT\_\-Sky\-Geom\_\-TAN}, 
{\bf OBIT\_\-Sky\-Geom\_\-ARC}, 
{\bf OBIT\_\-Sky\-Geom\_\-NCP}, 
\par
{\bf OBIT\_\-Sky\-Geom\_\-GLS}, 
{\bf OBIT\_\-Sky\-Geom\_\-MER}, 
{\bf OBIT\_\-Sky\-Geom\_\-AIT}, 
{\bf OBIT\_\-Sky\-Geom\_\-STG}
 \}
\begin{CompactList}\small\item\em enum for Sky\-Geom projection types. \item\end{CompactList}\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
void {\bf Obit\-Sky\-Geom\-Shift\-XY} ({\bf odouble} ra, {\bf odouble} dec, {\bf ofloat} rotate, {\bf odouble} shift\-RA, {\bf odouble} shift\-Dec, {\bf ofloat} $\ast$x\-Shift, {\bf ofloat} $\ast$y\-Shift)
\begin{CompactList}\small\item\em Public: Determine shift between two positions. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-XYShift} ({\bf odouble} ra, {\bf odouble} dec, {\bf ofloat} x\-Shift, {\bf ofloat} y\-Shift, {\bf ofloat} rotate, {\bf odouble} $\ast$shift\-RA, {\bf odouble} $\ast$shift\-Dec)
\begin{CompactList}\small\item\em Public: Determine result of a shift to a position. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Shift\-SIN} ({\bf odouble} ra, {\bf odouble} dec, {\bf ofloat} rotate, {\bf odouble} xra, double xdec, {\bf ofloat} dxyzc[3])
\begin{CompactList}\small\item\em Public: Get shift parameters for -SIN projection. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Shift\-NCP} ({\bf odouble} ra, {\bf odouble} dec, {\bf ofloat} rotate, {\bf odouble} xra, double xdec, {\bf ofloat} dxyzc[3])
\begin{CompactList}\small\item\em Public: Get shift parameters for -NCP projection. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-New\-Pos} (Obit\-Sky\-Geom\-Proj Proj, {\bf odouble} ra0, {\bf odouble} dec0, {\bf odouble} l, {\bf odouble} m, {\bf odouble} $\ast$raout, {\bf odouble} $\ast$decout, {\bf olong} $\ast$ierr)
\begin{CompactList}\small\item\em Public: Returns astronomical coordinates given direction cosines, projection. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-World\-Pos} ({\bf ofloat} xpix, {\bf ofloat} ypix, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xrefpix, {\bf ofloat} yrefpix, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, gchar $\ast$type, {\bf odouble} $\ast$xpos, {\bf odouble} $\ast$ypos)
\begin{CompactList}\small\item\em Public: accurate position for pixel coordinates. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-CDpos} ({\bf ofloat} xpix, {\bf ofloat} ypix, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xrefpix, {\bf ofloat} yrefpix, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, {\bf ofloat} cd1[2], {\bf ofloat} cd2[2], gchar $\ast$type, {\bf odouble} $\ast$xpos, {\bf odouble} $\ast$ypos)
\begin{CompactList}\small\item\em Public: Position for pixel coordinates from IRAF style CD matrix. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-XYpix} ({\bf odouble} xpos, {\bf odouble} ypos, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xrefpix, {\bf ofloat} yrefpix, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, gchar $\ast$type, {\bf ofloat} $\ast$xpix, {\bf ofloat} $\ast$ypix)
\begin{CompactList}\small\item\em Public: Pixel coordinates for an RA and Dec. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-CDpix} ({\bf odouble} xpos, {\bf odouble} ypos, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xrefpix, {\bf ofloat} yrefpix, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, {\bf ofloat} icd1[2], {\bf ofloat} icd2[2], gchar $\ast$type, {\bf ofloat} $\ast$xpix, {\bf ofloat} $\ast$ypix)
\begin{CompactList}\small\item\em Public:pixel coordinates for an RA and Dec from IRAF style CD matrix. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-World\-Pos\-LM} ({\bf odouble} dx, {\bf odouble} dy, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, gchar $\ast$type, {\bf odouble} $\ast$xpos, {\bf odouble} $\ast$ypos)
\begin{CompactList}\small\item\em Public: Position for pixel coordinates from offsets from the reference position. \item\end{CompactList}\item 
{\bf olong} {\bf Obit\-Sky\-Geom\-XYPix\-LM} ({\bf odouble} xpos, {\bf odouble} ypos, {\bf odouble} xref, {\bf odouble} yref, {\bf ofloat} xinc, {\bf ofloat} yinc, {\bf ofloat} rot, gchar $\ast$type, {\bf odouble} $\ast$dx, {\bf odouble} $\ast$dy)
\begin{CompactList}\small\item\em Public: Coordinate offsets for an RA and Dec. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Bto\-J} ({\bf odouble} $\ast$ra, {\bf odouble} $\ast$dec)
\begin{CompactList}\small\item\em Public: Precess B1950 to J2000 coordinates. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Jto\-B} ({\bf odouble} $\ast$ra, {\bf odouble} $\ast$dec)
\begin{CompactList}\small\item\em Public: Precess J2000 to B1950 coordinates. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Eq2Gal} ({\bf odouble} $\ast$RALong, {\bf odouble} $\ast$Dec\-Lat)
\begin{CompactList}\small\item\em Public: Convert Equatorial (B1950) to Galactic coordinates. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Gal2Eq} ({\bf odouble} $\ast$RALong, {\bf odouble} $\ast$Dec\-Lat)
\begin{CompactList}\small\item\em Public: Convert Galactic to Equatorial (B1950). \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Eq2Ec} ({\bf odouble} $\ast$RALong, {\bf odouble} $\ast$Dec\-Lat, {\bf ofloat} epoch)
\begin{CompactList}\small\item\em Public: Convert Equatorial to Ecliptic coordinates. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-Ec2Eq} ({\bf odouble} $\ast$RALong, {\bf odouble} $\ast$Dec\-Lat, {\bf ofloat} epoch)
\begin{CompactList}\small\item\em Public: Convert Ecliptic to Equatorial. \item\end{CompactList}\item 
void {\bf Obit\-Sky\-Geom\-RADec2Zern} ({\bf odouble} ra, {\bf odouble} dec, {\bf ofloat} xshift, {\bf ofloat} yshift, {\bf ofloat} $\ast$xzer, {\bf ofloat} $\ast$yzer, {\bf olong} $\ast$ierr)
\begin{CompactList}\small\item\em Public: Projection to Zernike plane. \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
Celestial coordinates utility module. 

This file contains utility functions for celestial coordinates

\subsection{Enumeration Type Documentation}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!obitSkyGeomProj@{obitSkyGeomProj}}
\index{obitSkyGeomProj@{obitSkyGeomProj}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}enum {\bf obit\-Sky\-Geom\-Proj}}\label{ObitSkyGeom_8h_a26}


enum for Sky\-Geom projection types. 

\begin{Desc}
\item[Enumeration values: ]\par
\begin{description}
\index{OBIT_SkyGeom_SIN@{OBIT\_\-SkyGeom\_\-SIN}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_SIN@{OBIT\_\-SkyGeom\_\-SIN}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-SIN\label{ObitSkyGeom_8h_a26a0}
}]-SIN Sin projection \index{OBIT_SkyGeom_TAN@{OBIT\_\-SkyGeom\_\-TAN}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_TAN@{OBIT\_\-SkyGeom\_\-TAN}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-TAN\label{ObitSkyGeom_8h_a26a1}
}]-TAN Tan projection \index{OBIT_SkyGeom_ARC@{OBIT\_\-SkyGeom\_\-ARC}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_ARC@{OBIT\_\-SkyGeom\_\-ARC}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-ARC\label{ObitSkyGeom_8h_a26a2}
}]-ARC Arc projection \index{OBIT_SkyGeom_NCP@{OBIT\_\-SkyGeom\_\-NCP}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_NCP@{OBIT\_\-SkyGeom\_\-NCP}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-NCP\label{ObitSkyGeom_8h_a26a3}
}]-NCP NCP (WSRT) projection \index{OBIT_SkyGeom_GLS@{OBIT\_\-SkyGeom\_\-GLS}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_GLS@{OBIT\_\-SkyGeom\_\-GLS}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-GLS\label{ObitSkyGeom_8h_a26a4}
}]-GLS Global sinusoid projection \index{OBIT_SkyGeom_MER@{OBIT\_\-SkyGeom\_\-MER}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_MER@{OBIT\_\-SkyGeom\_\-MER}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-MER\label{ObitSkyGeom_8h_a26a5}
}]-MER Mercator projection \index{OBIT_SkyGeom_AIT@{OBIT\_\-SkyGeom\_\-AIT}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_AIT@{OBIT\_\-SkyGeom\_\-AIT}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-AIT\label{ObitSkyGeom_8h_a26a6}
}]-AIT Aitoff projection \index{OBIT_SkyGeom_STG@{OBIT\_\-SkyGeom\_\-STG}!ObitSkyGeom.h@{ObitSkyGeom.h}}\index{ObitSkyGeom.h@{ObitSkyGeom.h}!OBIT_SkyGeom_STG@{OBIT\_\-SkyGeom\_\-STG}}\item[{\em 
OBIT\_\-Sky\-Geom\_\-STG\label{ObitSkyGeom_8h_a26a7}
}]-STG Stereographic projection \end{description}
\end{Desc}



\subsection{Function Documentation}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomBtoJ@{ObitSkyGeomBtoJ}}
\index{ObitSkyGeomBtoJ@{ObitSkyGeomBtoJ}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Bto\-J ({\bf odouble} $\ast$ {\em ra}, {\bf odouble} $\ast$ {\em dec})}\label{ObitSkyGeom_8h_a19}


Public: Precess B1950 to J2000 coordinates. 

J. Condon Taken from FITSview family \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]in/out Right Ascension in degrees \item[{\em dec}]in/out Declination in degrees \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomCDpix@{ObitSkyGeomCDpix}}
\index{ObitSkyGeomCDpix@{ObitSkyGeomCDpix}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-CDpix ({\bf odouble} {\em xpos}, {\bf odouble} {\em ypos}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xrefpix}, {\bf ofloat} {\em yrefpix}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, {\bf ofloat} {\em icd1}[2], {\bf ofloat} {\em icd2}[2], gchar $\ast$ {\em type}, {\bf ofloat} $\ast$ {\em xpix}, {\bf ofloat} $\ast$ {\em ypix})}\label{ObitSkyGeom_8h_a16}


Public:pixel coordinates for an RA and Dec from IRAF style CD matrix. 

Note: xinc, yinc, and rot can be derived from cd1 and cd2 and should be compatible with them. Taken from FITSview family \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em xpos}]x (RA) coordinate (deg) \item[{\em ypos}]y (dec) coordinate (deg) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg) \item[{\em xrefpix}]x reference pixel \item[{\em yrefpix}]y reference pixel \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em cd1}]first column of CD matrix \item[{\em cd2}]second column of CD matrix \item[{\em xpix}][out] x pixel number (RA or long without rotation) \item[{\em ypix}][out] y pixel number (dec or lat without rotation) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection 2 = bad values \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomCDpos@{ObitSkyGeomCDpos}}
\index{ObitSkyGeomCDpos@{ObitSkyGeomCDpos}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-CDpos ({\bf ofloat} {\em xpix}, {\bf ofloat} {\em ypix}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xrefpix}, {\bf ofloat} {\em yrefpix}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, {\bf ofloat} {\em cd1}[2], {\bf ofloat} {\em cd2}[2], gchar $\ast$ {\em type}, {\bf odouble} $\ast$ {\em xpos}, {\bf odouble} $\ast$ {\em ypos})}\label{ObitSkyGeom_8h_a14}


Public: Position for pixel coordinates from IRAF style CD matrix. 

Note: xinc, yinc, and rot can be derived from cd1 and cd2 and should be compatible with them. Taken from FITSview family \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em xpix}]x pixel number (RA or long without rotation) \item[{\em ypix}]y pixel number (dec or lat without rotation) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg) \item[{\em xrefpix}]x reference pixel \item[{\em yrefpix}]y reference pixel \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em cd1}]first column of CD matrix \item[{\em cd2}]second column of CD matrix \item[{\em xpos}][out] x (RA) coordinate (deg) \item[{\em ypos}][out]y (dec) coordinate (deg) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection; \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomEc2Eq@{ObitSkyGeomEc2Eq}}
\index{ObitSkyGeomEc2Eq@{ObitSkyGeomEc2Eq}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Ec2Eq ({\bf odouble} $\ast$ {\em RALong}, {\bf odouble} $\ast$ {\em Dec\-Lat}, {\bf ofloat} {\em epoch})}\label{ObitSkyGeom_8h_a24}


Public: Convert Ecliptic to Equatorial. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em RALong}]in/out Right Ascension/longitude in degrees \item[{\em Dec\-Lat}]in/out Declination.latitude in degrees \item[{\em epoch}]Epoch of the coordinates to transform \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomEq2Ec@{ObitSkyGeomEq2Ec}}
\index{ObitSkyGeomEq2Ec@{ObitSkyGeomEq2Ec}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Eq2Ec ({\bf odouble} $\ast$ {\em RALong}, {\bf odouble} $\ast$ {\em Dec\-Lat}, {\bf ofloat} {\em epoch})}\label{ObitSkyGeom_8h_a23}


Public: Convert Equatorial to Ecliptic coordinates. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em RALong}]in/out Right Ascension/longitude in degrees \item[{\em Dec\-Lat}]in/out Declination.latitude in degrees \item[{\em epoch}]Epoch of the coordinates to transform \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomEq2Gal@{ObitSkyGeomEq2Gal}}
\index{ObitSkyGeomEq2Gal@{ObitSkyGeomEq2Gal}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Eq2Gal ({\bf odouble} $\ast$ {\em RALong}, {\bf odouble} $\ast$ {\em Dec\-Lat})}\label{ObitSkyGeom_8h_a21}


Public: Convert Equatorial (B1950) to Galactic coordinates. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em RALong}]in/out Right Ascension/longitude in degrees \item[{\em Dec\-Lat}]in/out Declination.latitude in degrees \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomGal2Eq@{ObitSkyGeomGal2Eq}}
\index{ObitSkyGeomGal2Eq@{ObitSkyGeomGal2Eq}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Gal2Eq ({\bf odouble} $\ast$ {\em RALong}, {\bf odouble} $\ast$ {\em Dec\-Lat})}\label{ObitSkyGeom_8h_a22}


Public: Convert Galactic to Equatorial (B1950). 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em RALong}]in/out Right Ascension/longitude in degrees \item[{\em Dec\-Lat}]in/out Declination.latitude in degrees \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomJtoB@{ObitSkyGeomJtoB}}
\index{ObitSkyGeomJtoB@{ObitSkyGeomJtoB}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Jto\-B ({\bf odouble} $\ast$ {\em ra}, {\bf odouble} $\ast$ {\em dec})}\label{ObitSkyGeom_8h_a20}


Public: Precess J2000 to B1950 coordinates. 

\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomNewPos@{ObitSkyGeomNewPos}}
\index{ObitSkyGeomNewPos@{ObitSkyGeomNewPos}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-New\-Pos (Obit\-Sky\-Geom\-Proj {\em Proj}, {\bf odouble} {\em ra0}, {\bf odouble} {\em dec0}, {\bf odouble} {\em l}, {\bf odouble} {\em m}, {\bf odouble} $\ast$ {\em raout}, {\bf odouble} $\ast$ {\em decout}, {\bf olong} $\ast$ {\em ierr})}\label{ObitSkyGeom_8h_a12}


Public: Returns astronomical coordinates given direction cosines, projection. 

the direction cosine l is assumed to be positive to the east; m is positive to the north. the routine works for 4 kinds of projective geometries and for celestial, ecliptic, or galactic coordinate systems. this subroutine always uses an accurate computation. All angles in this subroutine are in radians. Adapted from the AIPSish NEWPOS.FOR. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em Proj}]Projection type (Aitoff and Mercator not supported) \item[{\em ra0}]coordinate reference right ascension (longitude) \item[{\em dec0}]coordinate reference declination (latitude) \item[{\em l}]cosine angle of displacement to east \item[{\em m}]cosine angle of displacement to north \item[{\em raout}][out] right ascension or longitude at (l,m) \item[{\em decout}][out] declination or latitude at (l,m) \item[{\em ierr}][out] error condition: 0 = ok, 1 = l,m crazy, 2 = bad type, 3 = answer undefined \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomRADec2Zern@{ObitSkyGeomRADec2Zern}}
\index{ObitSkyGeomRADec2Zern@{ObitSkyGeomRADec2Zern}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-RADec2Zern ({\bf odouble} {\em ra}, {\bf odouble} {\em dec}, {\bf ofloat} {\em xshift}, {\bf ofloat} {\em yshift}, {\bf ofloat} $\ast$ {\em xzer}, {\bf ofloat} $\ast$ {\em yzer}, {\bf olong} $\ast$ {\em ierr})}\label{ObitSkyGeom_8h_a25}


Public: Projection to Zernike plane. 

The output coordinates are normalized to unity at a 10 deg radius from the reference position. The coordinates are projected onto a plane tangent to the sky at the reference position. Routine translated from the AIPSish ZERGEOM.FOR/RD2ZER \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]Right Ascention of reference position (deg) \item[{\em dec}]Declination of reference position (deg) \item[{\em xshift}]Shift in X (RA) to desired position (deg) \item[{\em yshift}]Shift in Y (Dec) to desired position (deg) \item[{\em xzer}][out] x-coordinate on Zernike plane \item[{\em yzer}][out] y-coordinate on Zernike plane \item[{\em ierr}]0 ok, 1 out of range \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomShiftNCP@{ObitSkyGeomShiftNCP}}
\index{ObitSkyGeomShiftNCP@{ObitSkyGeomShiftNCP}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Shift\-NCP ({\bf odouble} {\em ra}, {\bf odouble} {\em dec}, {\bf ofloat} {\em rotate}, {\bf odouble} {\em xra}, double {\em xdec}, {\bf ofloat} {\em dxyzc}[3])}\label{ObitSkyGeom_8h_a11}


Public: Get shift parameters for -NCP projection. 

Adapted from the AIPSish SHINCP.FOR. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]Initial RA in degrees: reference position \item[{\em dec}]Initial Declination in degrees \item[{\em rotate}]Image rotation in degrees \item[{\em xra}]RA of shifted point in degrees \item[{\em xdec}]Declination of shifted point in degrees \item[{\em dxyzc}](out) Phase term for Position offsets in x,y,z \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomShiftSIN@{ObitSkyGeomShiftSIN}}
\index{ObitSkyGeomShiftSIN@{ObitSkyGeomShiftSIN}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Shift\-SIN ({\bf odouble} {\em ra}, {\bf odouble} {\em dec}, {\bf ofloat} {\em rotate}, {\bf odouble} {\em xra}, double {\em xdec}, {\bf ofloat} {\em dxyzc}[3])}\label{ObitSkyGeom_8h_a10}


Public: Get shift parameters for -SIN projection. 

Adapted from the AIPSish SHISIN.FOR. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]Initial RA in degrees: reference position \item[{\em dec}]Initial Declination in degrees \item[{\em rotate}]Image rotation in degrees \item[{\em xra}]RA of shifted point in degrees \item[{\em xdec}]Declination of shifted point in degrees \item[{\em dxyzc}](out) Phase term for Position offsets in x,y,z (2pi turns) \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomShiftXY@{ObitSkyGeomShiftXY}}
\index{ObitSkyGeomShiftXY@{ObitSkyGeomShiftXY}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-Shift\-XY ({\bf odouble} {\em ra}, {\bf odouble} {\em dec}, {\bf ofloat} {\em rotate}, {\bf odouble} {\em shift\-RA}, {\bf odouble} {\em shift\-Dec}, {\bf ofloat} $\ast$ {\em x\-Shift}, {\bf ofloat} $\ast$ {\em y\-Shift})}\label{ObitSkyGeom_8h_a8}


Public: Determine shift between two positions. 

The shift is in (possibly) rotated coordinates. Adopted from the AIPSish SHFTXY.FOR \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]Initial Right Ascension in deg. \item[{\em dec}]Initial declination in deg. \item[{\em rotate}]Rotation of field, to E from N, deg. \item[{\em shift\-RA}]Shifted Right Ascension in deg. \item[{\em shift\-Dec}]Shifted declination in deg. \item[{\em x\-Shift}](out) Shift from ra to shift\-RA in deg. \item[{\em y\-Shift}](out) Shift from dec to shift\-Dec in deg. \end{description}
\end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomWorldPos@{ObitSkyGeomWorldPos}}
\index{ObitSkyGeomWorldPos@{ObitSkyGeomWorldPos}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-World\-Pos ({\bf ofloat} {\em xpix}, {\bf ofloat} {\em ypix}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xrefpix}, {\bf ofloat} {\em yrefpix}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, gchar $\ast$ {\em type}, {\bf odouble} $\ast$ {\em xpos}, {\bf odouble} $\ast$ {\em ypos})}\label{ObitSkyGeom_8h_a13}


Public: accurate position for pixel coordinates. 

Taken from FITSview family \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em xpix}]x pixel number (RA or long without rotation) \item[{\em ypix}]y pixel number (dec or lat without rotation) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg) \item[{\em xrefpix}]x reference pixel \item[{\em yrefpix}]y reference pixel \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em xpos}][out] x (RA) coordinate (deg) \item[{\em ypos}][out]y (dec) coordinate (deg) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection; \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomWorldPosLM@{ObitSkyGeomWorldPosLM}}
\index{ObitSkyGeomWorldPosLM@{ObitSkyGeomWorldPosLM}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-World\-Pos\-LM ({\bf odouble} {\em dx}, {\bf odouble} {\em dy}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, gchar $\ast$ {\em type}, {\bf odouble} $\ast$ {\em xpos}, {\bf odouble} $\ast$ {\em ypos})}\label{ObitSkyGeom_8h_a17}


Public: Position for pixel coordinates from offsets from the reference position. 

Taken from FITSview family \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dx}]x coordinate offset (RA or long) \item[{\em dy}]y coordinate offset (dec or lat) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em xpos}][out] x (RA) coordinate (deg) \item[{\em ypos}][out] y (dec) coordinate (deg) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection; \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomXYpix@{ObitSkyGeomXYpix}}
\index{ObitSkyGeomXYpix@{ObitSkyGeomXYpix}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-XYpix ({\bf odouble} {\em xpos}, {\bf odouble} {\em ypos}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xrefpix}, {\bf ofloat} {\em yrefpix}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, gchar $\ast$ {\em type}, {\bf ofloat} $\ast$ {\em xpix}, {\bf ofloat} $\ast$ {\em ypix})}\label{ObitSkyGeom_8h_a15}


Public: Pixel coordinates for an RA and Dec. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em xpos}]x (RA) coordinate (deg) \item[{\em ypos}]y (dec) coordinate (deg) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg) \item[{\em xrefpix}]x reference pixel \item[{\em yrefpix}]y reference pixel \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em xpix}][out] x pixel number (RA or long without rotation) \item[{\em ypix}][out] y pixel number (dec or lat without rotation) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection 2 = bad values \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomXYPixLM@{ObitSkyGeomXYPixLM}}
\index{ObitSkyGeomXYPixLM@{ObitSkyGeomXYPixLM}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf olong} Obit\-Sky\-Geom\-XYPix\-LM ({\bf odouble} {\em xpos}, {\bf odouble} {\em ypos}, {\bf odouble} {\em xref}, {\bf odouble} {\em yref}, {\bf ofloat} {\em xinc}, {\bf ofloat} {\em yinc}, {\bf ofloat} {\em rot}, gchar $\ast$ {\em type}, {\bf odouble} $\ast$ {\em dx}, {\bf odouble} $\ast$ {\em dy})}\label{ObitSkyGeom_8h_a18}


Public: Coordinate offsets for an RA and Dec. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em xpos}]x (RA) coordinate (deg) \item[{\em ypos}]y (dec) coordinate (deg) \item[{\em xref}]x reference coordinate value (deg) \item[{\em yref}]y reference coordinate value (deg) \item[{\em xrefpix}]x reference pixel \item[{\em yrefpix}]y reference pixel \item[{\em xinc}]x coordinate increment (deg) \item[{\em yinc}]y coordinate increment (deg) \item[{\em rot}]rotation (deg) (from N through E) \item[{\em type}]projection type code e.g. \char`\"{}-SIN\char`\"{} Does: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections anything else is linear \item[{\em dx}][out] x projected offset (RA or long without rotation) \item[{\em dy}][out] y projected offset (dec or lat without rotation) \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]0 if successful otherwise: 1 = angle too large for projection 2 = bad values \end{Desc}
\index{ObitSkyGeom.h@{Obit\-Sky\-Geom.h}!ObitSkyGeomXYShift@{ObitSkyGeomXYShift}}
\index{ObitSkyGeomXYShift@{ObitSkyGeomXYShift}!ObitSkyGeom.h@{Obit\-Sky\-Geom.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Obit\-Sky\-Geom\-XYShift ({\bf odouble} {\em ra}, {\bf odouble} {\em dec}, {\bf ofloat} {\em x\-Shift}, {\bf ofloat} {\em y\-Shift}, {\bf ofloat} {\em rotate}, {\bf odouble} $\ast$ {\em shift\-RA}, {\bf odouble} $\ast$ {\em shift\-Dec})}\label{ObitSkyGeom_8h_a9}


Public: Determine result of a shift to a position. 

The shift is in (possibly) rotated coordinates. Adopted from the AIPSish XYSHFT.FOR \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ra}]Initial Right Ascension in deg. \item[{\em dec}]Initial declination in deg. \item[{\em x\-Shift}]Shift from ra to shift\-RA in deg. \item[{\em y\-Shift}]Shift from dec to shift\-Dec in deg. \item[{\em rotate}]Rotation of field, to E from N, deg. \item[{\em shift\-RA}](out) Shifted Right Ascension in deg. \item[{\em shift\-Dec}](out) Shifted declination in deg. \end{description}
\end{Desc}
